import os
import sys
import time
import json
import logging
import qrcode
import threading
import hashlib
import re
import random
import string
import collections
from datetime import datetime, timedelta
from io import BytesIO
from contextlib import contextmanager
import sqlite3
import requests

from flask import Flask, request, jsonify
from telebot import TeleBot, types
from telebot.apihelper import ApiException, ApiTelegramException
from PIL import Image, ImageDraw, ImageFont
import html

TOKEN = os.getenv("PLAY", "")
ADMIN_ID = int(os.getenv("ADMIN_ID", "7549204023"))
CHANNEL = os.getenv("CHANNEL", "")
WEBHOOK_HOST = os.getenv("WEBHOOK_HOST", "https://songaura.onrender.com")
PORT = int(os.getenv("PORT", "10000"))
DB_PATH = os.getenv("DB_PATH", "data.db")

ANTISPAM_INTERVAL = 2
MAX_REQUESTS_PER_MINUTE = 30
MAX_FILE_SIZE = 50 * 1024 * 1024
MAX_MESSAGE_LENGTH = 4000
SESSION_TIMEOUT = 300

BLACKLIST_WORDS = [
    'ÑĞ¿Ğ°Ğ¼', 'Ñ€ĞµĞºĞ»Ğ°Ğ¼Ğ°', 'ÑĞºĞ°Ğ¼', 'Ğ¼Ğ¾ÑˆĞµĞ½Ğ½Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾', 'Ğ¾Ğ±Ğ¼Ğ°Ğ½',
    'Ğ²Ğ·Ğ»Ğ¾Ğ¼', 'Ñ…Ğ°Ğº', 'Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ', 'ĞºĞ°Ñ€Ñ‚Ğ°', 'Ğ±Ğ°Ğ½Ğº', 'ĞºÑ€ĞµĞ´Ğ¸Ñ‚',
    'Ğ¿Ğ¾Ñ€Ğ½Ğ¾', 'Ğ¿Ğ¾Ñ€Ğ½Ğ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ', 'Ğ½Ğ°Ñ€ĞºĞ¾', 'drug', 'sex',
    'Ğ¾ÑĞºĞ¾Ñ€Ğ±Ğ»ĞµĞ½Ğ¸Ğµ', 'ÑƒĞ³Ñ€Ğ¾Ğ·Ğ°', 'ÑˆĞ°Ğ½Ñ‚Ğ°Ğ¶'
]

logging.basicConfig(
    level=os.getenv("LOG_LEVEL", "INFO"),
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.StreamHandler(sys.stdout),
        logging.FileHandler('bot.log', encoding='utf-8')
    ]
)
logger = logging.getLogger(__name__)

bot = TeleBot(TOKEN, parse_mode="HTML", num_threads=4)
app = Flask(__name__)

user_sessions = {}
admin_modes = {}
message_cooldown = {}
request_counts = {}
rate_limit_cache = {}
file_cache = {}
session_timestamps = {}
admin_settings = {
    'auto_moderation': True,
    'notify_admin_new_user': True,
    'notify_admin_new_message': True,
    'auto_backup_hours': 24,
    'max_messages_per_day': 100,
    'language': 'ru'
}

TEXTS = {
    'ru': {
        'start': """ğŸ‰ <b>Ğ”ĞĞ‘Ğ Ğ ĞŸĞĞ–ĞĞ›ĞĞ’ĞĞ¢Ğ¬ Ğ’ ANONY SMS!</b> ğŸ‰

<code>âœ¨ Ğ—Ğ´ĞµÑÑŒ Ñ‚Ğ°Ğ¹Ğ½Ñ‹ Ğ¾Ğ¶Ğ¸Ğ²Ğ°ÑÑ‚, Ğ° ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¸ ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ÑÑ‚ÑÑ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸ÑĞ¼Ğ¸!</code>

<b>ğŸ­ ĞĞ‘Ğ¡ĞĞ›Ğ®Ğ¢ĞĞĞ¯ ĞĞĞĞĞ˜ĞœĞĞĞ¡Ğ¢Ğ¬</b>
â€¢ ĞĞ¸ĞºÑ‚Ğ¾ Ğ½Ğµ ÑƒĞ·Ğ½Ğ°ĞµÑ‚, ĞºÑ‚Ğ¾ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ» ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ
â€¢ ĞŸĞ¾Ğ»Ğ½Ğ°Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ´ĞµĞ½Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°
â€¢ Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‡ĞµÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¸ Ğ¸ÑĞºÑ€ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ

<b>ğŸ”— Ğ¢Ğ’ĞĞ¯ Ğ£ĞĞ˜ĞšĞĞ›Ğ¬ĞĞĞ¯ Ğ¡Ğ¡Ğ«Ğ›ĞšĞ:</b>
<code>{link}</code>

<b>ğŸš€ ĞšĞĞš Ğ­Ğ¢Ğ Ğ ĞĞ‘ĞĞ¢ĞĞ•Ğ¢:</b>
1ï¸âƒ£ <i>ĞŸĞ¾Ğ´ĞµĞ»Ğ¸ÑÑŒ ÑÑÑ‹Ğ»ĞºĞ¾Ğ¹ Ñ Ğ´Ñ€ÑƒĞ·ÑŒÑĞ¼Ğ¸</i>
2ï¸âƒ£ <i>ĞĞ½Ğ¸ Ğ¿Ğ¸ÑˆÑƒÑ‚ Ñ‚ĞµĞ±Ğµ Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ</i>
3ï¸âƒ£ <i>Ğ¢Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑˆÑŒ Ñ‚Ğ°Ğ¹Ğ½Ñ‹Ğµ Ğ¿Ğ¾ÑĞ»Ğ°Ğ½Ğ¸Ñ</i>
4ï¸âƒ£ <i>Ğ£Ğ³Ğ°Ğ´Ñ‹Ğ²Ğ°Ğ¹, ĞºÑ‚Ğ¾ ÑÑ‚Ğ¾ Ğ¼Ğ¾Ğ³ Ğ±Ñ‹Ñ‚ÑŒ! ğŸ˜</i>

<b>ğŸ’Œ ĞœĞĞ–ĞĞ ĞĞ¢ĞŸĞ ĞĞ’Ğ˜Ğ¢Ğ¬:</b>
ğŸ“ Ğ¢ĞµĞºÑÑ‚ | ğŸ“¸ Ğ¤Ğ¾Ñ‚Ğ¾ | ğŸ¬ Ğ’Ğ¸Ğ´ĞµĞ¾ | ğŸ¤ Ğ“Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²Ğ¾Ğµ | ğŸ“ Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ | ğŸ˜œ Ğ¡Ñ‚Ğ¸ĞºĞµÑ€

<i>Ğ“Ğ¾Ñ‚Ğ¾Ğ² Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¼Ğ¸Ñ€ Ñ‚Ğ°Ğ¹Ğ½? Ğ–Ğ¼Ğ¸ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ½Ğ¸Ğ¶Ğµ! ğŸ‘‡</i>""",
        
        'start_ref': """ğŸ¯ <b>Ğ’Ğ« ĞŸĞ•Ğ Ğ•Ğ¨Ğ›Ğ˜ ĞŸĞ Ğ¡Ğ¡Ğ«Ğ›ĞšĞ• ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞ¢Ğ•Ğ›Ğ¯!</b>

<i>Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ²Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ¾Ğ¼Ñƒ Ñ‡ĞµĞ»Ğ¾Ğ²ĞµĞºÑƒ <b>Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ</b>.</i>

<b>ğŸ”’ Ğ’ĞĞ¨Ğ ĞĞĞĞĞ˜ĞœĞĞĞ¡Ğ¢Ğ¬ Ğ“ĞĞ ĞĞĞ¢Ğ˜Ğ ĞĞ’ĞĞĞ:</b>
â€¢ ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğµ ÑƒĞ²Ğ¸Ğ´Ğ¸Ñ‚ Ğ²Ğ°ÑˆĞµ Ğ¸Ğ¼Ñ
â€¢ ĞĞµ ÑƒĞ·Ğ½Ğ°ĞµÑ‚ Ğ²Ğ°Ñˆ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ
â€¢ Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ±ÑƒĞ´ĞµÑ‚ Ğ°Ğ±ÑĞ¾Ğ»ÑÑ‚Ğ½Ğ¾ Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ñ‹Ğ¼

<b>ğŸ’Œ Ğ§Ğ¢Ğ ĞœĞĞ–ĞĞ ĞĞ¢ĞŸĞ ĞĞ’Ğ˜Ğ¢Ğ¬:</b>
â€¢ Ğ¢ĞµĞºÑÑ‚Ğ¾Ğ²Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ âœï¸
â€¢ Ğ¤Ğ¾Ñ‚Ğ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ Ğ¸Ğ»Ğ¸ ĞºĞ°Ñ€Ñ‚Ğ¸Ğ½ĞºÑƒ ğŸ“¸
â€¢ Ğ’Ğ¸Ğ´ĞµĞ¾ Ğ¸Ğ»Ğ¸ Ğ³Ğ¸Ñ„ĞºÑƒ ğŸ¬
â€¢ Ğ“Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ ğŸ¤
â€¢ Ğ›ÑĞ±Ğ¾Ğ¹ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ ğŸ“
â€¢ Ğ—Ğ°Ğ±Ğ°Ğ²Ğ½Ñ‹Ğ¹ ÑÑ‚Ğ¸ĞºĞµÑ€ ğŸ˜œ

<i>ĞĞ°Ğ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ Ğ²Ğ°ÑˆĞµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ½Ğ¸Ğ¶Ğµ Ğ¸ Ğ½Ğ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ. Ğ¢Ğ°Ğ¹Ğ½Ğ° Ğ±ÑƒĞ´ĞµÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ°! ğŸ¤«</i>""",
        
        'my_link': """ğŸ”— <b>Ğ’ĞĞ¨Ğ ĞŸĞ•Ğ Ğ¡ĞĞĞĞ›Ğ¬ĞĞĞ¯ Ğ¡Ğ¡Ğ«Ğ›ĞšĞ Ğ”Ğ›Ğ¯ ĞĞĞĞĞ˜ĞœĞĞš</b>

<code>{link}</code>

<b>ğŸš€ ĞšĞĞš Ğ˜Ğ¡ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞ¢Ğ¬:</b>
1. <i>Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ ÑÑÑ‹Ğ»ĞºÑƒ Ğ²Ñ‹ÑˆĞµ</i>
2. <i>ĞŸĞ¾Ğ´ĞµĞ»Ğ¸Ñ‚ĞµÑÑŒ Ğ² Telegram-Ñ‡Ğ°Ñ‚Ğ°Ñ…</i>
3. <i>Ğ Ğ°Ğ·Ğ¼ĞµÑÑ‚Ğ¸Ñ‚Ğµ Ğ² ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Instagram</i>
4. <i>ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ Ğ´Ñ€ÑƒĞ·ÑŒÑĞ¼ Ğ² ÑĞ¾Ñ†ÑĞµÑ‚ÑÑ…</i>
5. <i>Ğ–Ğ´Ğ¸Ñ‚Ğµ Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ!</i>

<b>ğŸ“ˆ Ğ¡Ğ¢ĞĞ¢Ğ˜Ğ¡Ğ¢Ğ˜ĞšĞ:</b>
â€¢ ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¾Ğ² Ğ¿Ğ¾ ÑÑÑ‹Ğ»ĞºĞµ: <b>{clicks}</b>
â€¢ ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¾ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹: <b>{received}</b>

<b>ğŸ’¡ Ğ¡ĞĞ’Ğ•Ğ¢:</b>
<i>Ğ§ĞµĞ¼ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ Ğ»ÑĞ´ĞµĞ¹ Ğ¿ĞµÑ€ĞµĞ¹Ğ´ĞµÑ‚ Ğ¿Ğ¾ Ğ²Ğ°ÑˆĞµĞ¹ ÑÑÑ‹Ğ»ĞºĞµ, Ñ‚ĞµĞ¼ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ Ñ‚Ğ°Ğ¹Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¸Ğ·Ğ½Ğ°Ğ½Ğ¸Ğ¹ Ğ¸ ĞºĞ¾Ğ¼Ğ¿Ğ»Ğ¸Ğ¼ĞµĞ½Ñ‚Ğ¾Ğ² Ğ²Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚Ğµ! ğŸ˜‰</i>""",
        
        'profile': """ğŸ‘¤ <b>Ğ’ĞĞ¨ ĞŸĞ ĞĞ¤Ğ˜Ğ›Ğ¬</b>

<b>ğŸ“Š ĞĞ¡ĞĞĞ’ĞĞĞ¯ Ğ˜ĞĞ¤ĞĞ ĞœĞĞ¦Ğ˜Ğ¯:</b>
â”œ ID Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ: <code>{user_id}</code>
â”œ Ğ˜Ğ¼Ñ: <b>{first_name}</b>
â”œ Username: {username}
â”œ Ğ¯Ğ·Ñ‹Ğº Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ°: {language}
â”œ Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ: <b>{registered}</b>
â”” ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½ÑÑ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ: <b>{last_active}</b>

<b>ğŸ“ˆ Ğ¡Ğ¢ĞĞ¢Ğ˜Ğ¡Ğ¢Ğ˜ĞšĞ:</b>
â”œ ğŸ“¨ ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¾ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹: <b>{received}</b>
â”œ ğŸ“¤ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¾ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹: <b>{sent}</b>
â”œ ğŸ”— ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¾Ğ² Ğ¿Ğ¾ ÑÑÑ‹Ğ»ĞºĞµ: <b>{clicks}</b>
â”” âš™ï¸ ĞŸÑ€Ğ¸Ñ‘Ğ¼ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹: {receive_status}

<b>ğŸ”— Ğ’ĞĞ¨Ğ Ğ¡Ğ¡Ğ«Ğ›ĞšĞ:</b>
<code>{link}</code>

<i>ĞŸĞ¾Ğ´ĞµĞ»Ğ¸Ñ‚ĞµÑÑŒ ÑÑÑ‹Ğ»ĞºĞ¾Ğ¹ Ñ Ğ´Ñ€ÑƒĞ·ÑŒÑĞ¼Ğ¸, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ÑŒ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ñ‹Ñ… ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹! âœ¨</i>""",
        
        'anonymous_message': """ğŸ“¨ <b>Ğ£ Ğ’ĞĞ¡ ĞĞĞ’ĞĞ• ĞĞĞĞĞ˜ĞœĞĞĞ• Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ•!</b>

<i>ĞšÑ‚Ğ¾-Ñ‚Ğ¾ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‡Ñ‚Ğ¾ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ» Ğ²Ğ°Ğ¼ Ñ‚Ğ°Ğ¹Ğ½Ğ¾Ğµ Ğ¿Ğ¾ÑĞ»Ğ°Ğ½Ğ¸Ğµ... ğŸ‘€</i>

{message_content}

<b>ğŸ”’ ĞĞ¢ĞŸĞ ĞĞ’Ğ˜Ğ¢Ğ•Ğ›Ğ¬:</b> <i>ĞĞµĞ¸Ğ·Ğ²ĞµÑÑ‚ĞµĞ½</i>
<b>â° Ğ’Ğ Ğ•ĞœĞ¯:</b> <i>Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‡Ñ‚Ğ¾</i>

<i>Ğ¥Ğ¾Ñ‚Ğ¸Ñ‚Ğµ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¸Ñ‚ÑŒ Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ğ¾? Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ "ğŸ’Œ ĞÑ‚Ğ²ĞµÑ‚Ğ¸Ñ‚ÑŒ" Ğ½Ğ¸Ğ¶Ğµ!</i>""",
        
        'message_sent': """âœ… <b>Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ• ĞĞ¢ĞŸĞ ĞĞ’Ğ›Ğ•ĞĞ ĞĞĞĞĞ˜ĞœĞĞ!</b>

<i>Ğ’Ğ°ÑˆĞµ Ğ¿Ğ¾ÑĞ»Ğ°Ğ½Ğ¸Ğµ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¾ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ĞµĞ»Ñ.</i>

<b>ğŸ¯ Ğ¡Ğ¢ĞĞ¢Ğ£Ğ¡:</b> Ğ”Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¾
<b>ğŸ”’ ĞĞĞĞĞ˜ĞœĞĞĞ¡Ğ¢Ğ¬:</b> 100%
<b>ğŸ‘¤ ĞŸĞĞ›Ğ£Ğ§ĞĞ¢Ğ•Ğ›Ğ¬:</b> ĞĞµ ÑƒĞ·Ğ½Ğ°ĞµÑ‚ Ğ²Ğ°Ñ

<i>Ğ¥Ğ¾Ñ‚Ğ¸Ñ‚Ğµ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ ĞµÑ‰Ñ‘ Ğ¾Ğ´Ğ½Ğ¾ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ? ĞŸÑ€Ğ¾ÑÑ‚Ğ¾ Ğ½Ğ°Ğ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ ĞµĞ³Ğ¾! âœï¸</i>""",
        
        'help': """â“ <b>ĞŸĞĞœĞĞ©Ğ¬ Ğ˜ Ğ˜ĞĞ¡Ğ¢Ğ Ğ£ĞšĞ¦Ğ˜Ğ¯</b>

<b>ğŸ¯ Ğ§Ğ¢Ğ Ğ¢ĞĞšĞĞ• ANONY SMS?</b>
Ğ­Ñ‚Ğ¾ Ğ±Ğ¾Ñ‚ Ğ´Ğ»Ñ <b>Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ğ¾Ğ¹</b> Ğ¿ĞµÑ€ĞµĞ¿Ğ¸ÑĞºĞ¸! Ğ’Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑ‚ÑŒ Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ÑŒ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ, Ğ½Ğµ Ñ€Ğ°ÑĞºÑ€Ñ‹Ğ²Ğ°Ñ ÑĞ²Ğ¾ĞµĞ¹ Ğ»Ğ¸Ñ‡Ğ½Ğ¾ÑÑ‚Ğ¸.

<b>ğŸ“¨ ĞšĞĞš ĞŸĞĞ›Ğ£Ğ§ĞĞ¢Ğ¬ Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ¯:</b>
1. ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ "ğŸ”— ĞœĞ¾Ñ ÑÑÑ‹Ğ»ĞºĞ°"
2. Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ ÑĞ²Ğ¾Ñ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½ÑƒÑ ÑÑÑ‹Ğ»ĞºÑƒ
3. ĞŸĞ¾Ğ´ĞµĞ»Ğ¸Ñ‚ĞµÑÑŒ Ñ Ğ´Ñ€ÑƒĞ·ÑŒÑĞ¼Ğ¸ Ğ² ÑĞ¾Ñ†ÑĞµÑ‚ÑÑ…
4. Ğ–Ğ´Ğ¸Ñ‚Ğµ Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ!

<b>âœ‰ï¸ ĞšĞĞš ĞĞ¢ĞŸĞ ĞĞ’Ğ›Ğ¯Ğ¢Ğ¬ Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ¯:</b>
1. ĞŸĞµÑ€ĞµĞ¹Ğ´Ğ¸Ñ‚Ğµ Ğ¿Ğ¾ Ñ‡ÑƒĞ¶Ğ¾Ğ¹ ÑÑÑ‹Ğ»ĞºĞµ
2. ĞĞ°Ğ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ
3. ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ - Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğµ ÑƒĞ·Ğ½Ğ°ĞµÑ‚ Ğ²Ğ°Ñ!

<b>ğŸ“ Ğ§Ğ¢Ğ ĞœĞĞ–ĞĞ ĞĞ¢ĞŸĞ ĞĞ’Ğ˜Ğ¢Ğ¬:</b>
âœ… Ğ¢ĞµĞºÑÑ‚Ğ¾Ğ²Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ
âœ… Ğ¤Ğ¾Ñ‚Ğ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ğ¸ Ğ¸ ĞºĞ°Ñ€Ñ‚Ğ¸Ğ½ĞºĞ¸
âœ… Ğ’Ğ¸Ğ´ĞµĞ¾ Ğ¸ GIF
âœ… Ğ“Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ
âœ… Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ¸ Ñ„Ğ°Ğ¹Ğ»Ñ‹
âœ… Ğ¡Ñ‚Ğ¸ĞºĞµÑ€Ñ‹ Ğ¸ ÑĞ¼Ğ¾Ğ´Ğ·Ğ¸

<b>âš™ï¸ ĞĞĞ¡Ğ¢Ğ ĞĞ™ĞšĞ˜:</b>
â€¢ Ğ’ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ/Ğ²Ñ‹ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
â€¢ Ğ¡Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ ÑĞ·Ñ‹Ğº Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ°
â€¢ ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ
â€¢ Ğ¡Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ QR-ĞºĞ¾Ğ´

<b>ğŸ”’ Ğ‘Ğ•Ğ—ĞĞŸĞĞ¡ĞĞĞ¡Ğ¢Ğ¬:</b>
â€¢ Ğ’ÑĞµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑÑÑ‚ÑÑ Ğ¼Ğ¾Ğ´ĞµÑ€Ğ°Ñ†Ğ¸ĞµĞ¹
â€¢ Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ ÑĞ¿Ğ°Ğ¼Ğ° Ğ¸ Ğ¾ÑĞºĞ¾Ñ€Ğ±Ğ»ĞµĞ½Ğ¸Ğ¹
â€¢ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ´ĞµĞ½Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°
â€¢ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ

<b>ğŸ†˜ ĞŸĞĞ”Ğ”Ğ•Ğ Ğ–ĞšĞ:</b>
Ğ’Ğ¾Ğ·Ğ½Ğ¸ĞºĞ»Ğ¸ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹? ĞĞ°Ğ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ Ğ½Ğ°Ğ¼ Ñ‡ĞµÑ€ĞµĞ· ĞºĞ½Ğ¾Ğ¿ĞºÑƒ "ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ°"!""",
        
        'settings': """âš™ï¸ <b>ĞĞĞ¡Ğ¢Ğ ĞĞ™ĞšĞ˜</b>

<i>ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‚Ğµ Ğ±Ğ¾Ñ‚ Ğ¿Ğ¾Ğ´ ÑĞ²Ğ¾Ğ¸ Ğ¿Ñ€ĞµĞ´Ğ¿Ğ¾Ñ‡Ñ‚ĞµĞ½Ğ¸Ñ:</i>

<b>ğŸ”” Ğ£Ğ’Ğ•Ğ”ĞĞœĞ›Ğ•ĞĞ˜Ğ¯:</b>
â€¢ Ğ’ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ/Ğ²Ñ‹ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
â€¢ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¿Ñ€Ğ¸Ğ²Ğ°Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸

<b>ğŸŒ Ğ¯Ğ—Ğ«Ğš:</b>
â€¢ Ğ ÑƒÑÑĞºĞ¸Ğ¹ / English
â€¢ Ğ¡Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ ÑĞ·Ñ‹Ğº Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ°

<b>ğŸ”’ Ğ‘Ğ•Ğ—ĞĞŸĞĞ¡ĞĞĞ¡Ğ¢Ğ¬:</b>
â€¢ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ´ĞµĞ½Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
â€¢ Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹

<i>Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ½ÑƒĞ¶Ğ½Ñ‹Ğ¹ Ğ¿ÑƒĞ½ĞºÑ‚ Ğ½Ğ¸Ğ¶Ğµ ğŸ‘‡</i>""",
        
        'turn_on': """âœ… <b>ĞŸĞ Ğ˜ĞĞœ ĞĞĞĞĞ˜ĞœĞĞ«Ğ¥ Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ™ Ğ’ĞšĞ›Ğ®Ğ§ĞĞ!</b>

<i>Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ²Ğ°ÑˆĞ¸ Ğ´Ñ€ÑƒĞ·ÑŒÑ Ğ¼Ğ¾Ğ³ÑƒÑ‚ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑ‚ÑŒ Ğ²Ğ°Ğ¼ Ñ‚Ğ°Ğ¹Ğ½Ñ‹Ğµ Ğ¿Ğ¾ÑĞ»Ğ°Ğ½Ğ¸Ñ!</i>

<b>ğŸ­ Ğ§Ğ¢Ğ Ğ¢Ğ•ĞŸĞ•Ğ Ğ¬:</b>
â€¢ Ğ”Ñ€ÑƒĞ·ÑŒÑ Ğ²Ğ¸Ğ´ÑÑ‚ Ğ²Ğ°ÑˆÑƒ ÑÑÑ‹Ğ»ĞºÑƒ
â€¢ ĞœĞ¾Ğ³ÑƒÑ‚ Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ
â€¢ Ğ’Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚Ğµ Ñ‚Ğ°Ğ¹Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¸Ğ·Ğ½Ğ°Ğ½Ğ¸Ñ
â€¢ Ğ£Ğ·Ğ½Ğ°Ñ‘Ñ‚Ğµ, Ñ‡Ñ‚Ğ¾ Ğ¾ Ğ²Ğ°Ñ Ğ´ÑƒĞ¼Ğ°ÑÑ‚ Ğ½Ğ° ÑĞ°Ğ¼Ğ¾Ğ¼ Ğ´ĞµĞ»Ğµ

<b>ğŸ’¡ Ğ¡ĞĞ’Ğ•Ğ¢:</b>
<i>ĞŸĞ¾Ğ´ĞµĞ»Ğ¸Ñ‚ĞµÑÑŒ ÑĞ²Ğ¾ĞµĞ¹ ÑÑÑ‹Ğ»ĞºĞ¾Ğ¹ Ğ² Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ñ… Ñ‡Ğ°Ñ‚Ğ°Ñ…, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹! ğŸ˜‰</i>""",
        
        'turn_off': """âœ… <b>ĞŸĞ Ğ˜ĞĞœ ĞĞĞĞĞ˜ĞœĞĞ«Ğ¥ Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ™ ĞĞ¢ĞšĞ›Ğ®Ğ§ĞĞ!</b>

<i>Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¸Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑŒ Ğ½Ğµ Ğ±ÑƒĞ´ÑƒÑ‚.</i>

<b>ğŸ”’ Ğ§Ğ¢Ğ Ğ˜Ğ—ĞœĞ•ĞĞ˜Ğ›ĞĞ¡Ğ¬:</b>
â€¢ ĞĞ¾Ğ²Ğ°Ñ ÑÑÑ‹Ğ»ĞºĞ° Ğ½Ğµ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ
â€¢ Ğ¡ÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑÑ‚ÑÑ
â€¢ Ğ’Ñ‹ Ğ²ÑÑ‘ ĞµÑ‰Ñ‘ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑ‚ÑŒ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ğ´Ñ€ÑƒĞ³Ğ¸Ğ¼
â€¢ Ğ’ Ğ»ÑĞ±Ğ¾Ğ¹ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑĞ½Ğ¾Ğ²Ğ° Ğ²ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼

<b>âš ï¸ Ğ’ĞĞ–ĞĞ:</b>
<i>ĞÑ‚ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼Ğ° Ğ½Ğµ ÑƒĞ´Ğ°Ğ»Ğ¸Ñ‚ ÑƒĞ¶Ğµ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ½Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ!</i>""",
        
        'language': """ğŸŒ <b>Ğ’Ğ«Ğ‘ĞĞ  Ğ¯Ğ—Ğ«ĞšĞ</b>

<i>Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ÑĞ·Ñ‹Ğº Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ° Ğ±Ğ¾Ñ‚Ğ°:</i>

<b>ğŸ‡·ğŸ‡º Ğ Ğ£Ğ¡Ğ¡ĞšĞ˜Ğ™</b>
â€¢ ĞŸĞ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ½Ğ° Ñ€ÑƒÑÑĞºĞ¾Ğ¼ ÑĞ·Ñ‹ĞºĞµ
â€¢ ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° ĞºĞ¸Ñ€Ğ¸Ğ»Ğ»Ğ¸Ñ†Ñ‹
â€¢ Ğ›Ğ¾ĞºĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹

<b>ğŸ‡ºğŸ‡¸ ENGLISH</b>
â€¢ English interface
â€¢ Full international support
â€¢ Latin alphabet

<i>ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Ğ½Ğ° Ğ½ÑƒĞ¶Ğ½ÑƒÑ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ½Ğ¸Ğ¶Ğµ ğŸ‘‡</i>""",
        
        'language_changed': """âœ… <b>Ğ¯Ğ—Ğ«Ğš Ğ˜Ğ—ĞœĞ•ĞĞĞ!</b>

<i>Ğ˜Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ±Ğ¾Ñ‚Ğ° Ñ‚ĞµĞ¿ĞµÑ€ÑŒ Ğ½Ğ° {language}.</i>

<b>ğŸ”„ Ğ˜Ğ—ĞœĞ•ĞĞ•ĞĞ˜Ğ¯:</b>
â€¢ Ğ’ÑĞµ Ñ‚ĞµĞºÑÑ‚Ñ‹ Ğ¿ĞµÑ€ĞµĞ²ĞµĞ´ĞµĞ½Ñ‹
â€¢ ĞšĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ½Ğ° Ğ½Ğ¾Ğ²Ğ¾Ğ¼ ÑĞ·Ñ‹ĞºĞµ
â€¢ ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ°Ğ´Ğ°Ğ¿Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹

<i>ĞŸÑ€Ğ¸ÑÑ‚Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ! âœ¨</i>""",
        
        'blocked': """ğŸš« <b>Ğ’Ğ« Ğ—ĞĞ‘Ğ›ĞĞšĞ˜Ğ ĞĞ’ĞĞĞ«!</b>

<i>Ğš ÑĞ¾Ğ¶Ğ°Ğ»ĞµĞ½Ğ¸Ñ, Ğ²Ñ‹ Ğ½Ğµ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒÑÑ ÑÑ‚Ğ¸Ğ¼ Ğ±Ğ¾Ñ‚Ğ¾Ğ¼.</i>

<b>ğŸ“ ĞšĞĞĞ¢ĞĞšĞ¢Ğ«:</b>
Ğ•ÑĞ»Ğ¸ Ğ²Ñ‹ ÑÑ‡Ğ¸Ñ‚Ğ°ĞµÑ‚Ğµ, Ñ‡Ñ‚Ğ¾ ÑÑ‚Ğ¾ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°, Ğ¿Ğ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, ÑĞ²ÑĞ¶Ğ¸Ñ‚ĞµÑÑŒ Ñ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ¾Ğ¹.

<i>ĞĞ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ·Ğ° ÑĞ¾Ğ±Ğ¾Ğ¹ Ğ¿Ñ€Ğ°Ğ²Ğ¾ Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ Ğ·Ğ° Ğ½Ğ°Ñ€ÑƒÑˆĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ».</i>""",
        
        'user_not_found': """âŒ <b>ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞ¢Ğ•Ğ›Ğ¬ ĞĞ• ĞĞĞ™Ğ”Ğ•Ğ</b>

<i>ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ñ Ñ‚Ğ°ĞºĞ¸Ğ¼Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸ Ğ½Ğµ Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ Ğ² Ğ±Ğ¾Ñ‚Ğµ.</i>

<b>ğŸ” Ğ’ĞĞ—ĞœĞĞ–ĞĞ«Ğ• ĞŸĞ Ğ˜Ğ§Ğ˜ĞĞ«:</b>
â€¢ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ ÑƒĞ´Ğ°Ğ»Ğ¸Ğ» Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚
â€¢ ĞĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ ID Ğ¸Ğ»Ğ¸ username
â€¢ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğ¸ĞºĞ¾Ğ³Ğ´Ğ° Ğ½Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ»ÑÑ Ğ±Ğ¾Ñ‚Ğ¾Ğ¼

<i>ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸ Ğ¿Ğ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ÑĞ½Ğ¾Ğ²Ğ°.</i>""",
        
        'messages_disabled': """âŒ <b>Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ¯ ĞĞ¢ĞšĞ›Ğ®Ğ§Ğ•ĞĞ«</b>

<i>Ğ­Ñ‚Ğ¾Ñ‚ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ¾Ñ‚ĞºĞ»ÑÑ‡Ğ¸Ğ» Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ñ‹Ñ… ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹.</i>

<b>ğŸ¤” Ğ§Ğ¢Ğ Ğ”Ğ•Ğ›ĞĞ¢Ğ¬:</b>
â€¢ ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¼Ñƒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
â€¢ Ğ”Ğ¾Ğ¶Ğ´Ğ¸Ñ‚ĞµÑÑŒ, Ğ¿Ğ¾ĞºĞ° Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ ÑĞ½Ğ¾Ğ²Ğ° Ğ²ĞºĞ»ÑÑ‡Ğ¸Ñ‚ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼
â€¢ ĞĞ°Ğ¹Ğ´Ğ¸Ñ‚Ğµ Ğ´Ñ€ÑƒĞ³Ğ¸Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ Ñ‡ĞµÑ€ĞµĞ· Ğ¸Ñ… ÑÑÑ‹Ğ»ĞºĞ¸

<i>Ğ£Ğ²Ğ°Ğ¶Ğ°Ğ¹Ñ‚Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¿Ñ€Ğ¸Ğ²Ğ°Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ´Ñ€ÑƒĞ³Ğ¸Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹.</i>""",
        
        'wait': """â³ <b>ĞŸĞĞ”ĞĞ–Ğ”Ğ˜Ğ¢Ğ• ĞĞ•ĞœĞĞĞ“Ğ</b>

<i>Ğ¡Ğ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹ Ğ¿Ğ¾Ğ´Ñ€ÑĞ´! ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¿Ğ¾Ğ´Ğ¾Ğ¶Ğ´Ğ¸Ñ‚Ğµ 2 ÑĞµĞºÑƒĞ½Ğ´Ñ‹.</i>

<b>âš¡ Ğ¡ĞšĞĞ ĞĞ¡Ğ¢Ğ¬:</b> 1 ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ² 2 ÑĞµĞºÑƒĞ½Ğ´Ñ‹
<b>ğŸ¯ Ğ¦Ğ•Ğ›Ğ¬:</b> Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ ÑĞ¿Ğ°Ğ¼Ğ°

<i>Ğ¡Ğ¿Ğ°ÑĞ¸Ğ±Ğ¾ Ğ·Ğ° Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ! ğŸ™</i>""",
        
        'canceled': """âŒ <b>ĞĞ¢ĞœĞ•ĞĞ•ĞĞ</b>

<i>Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ¾Ñ‚Ğ¼ĞµĞ½ĞµĞ½Ğ¾.</i>

<b>ğŸ”„ Ğ’ĞĞ—Ğ’Ğ ĞĞ¢:</b> Ğ’ Ğ³Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ Ğ¼ĞµĞ½Ñ
<b>ğŸ“‹ Ğ¡Ğ¢ĞĞ¢Ğ£Ğ¡:</b> Ğ“Ğ¾Ñ‚Ğ¾Ğ² Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğµ

<i>Ğ§Ñ‚Ğ¾ Ñ…Ğ¾Ñ‚Ğ¸Ñ‚Ğµ ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ Ğ´Ğ°Ğ»ÑŒÑˆĞµ? ğŸ‘‡</i>""",
        
        'spam_wait': """â³ <b>ĞĞĞ¢Ğ˜Ğ¡ĞŸĞĞœ Ğ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞ</b>

<i>ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¿Ğ¾Ğ´Ğ¾Ğ¶Ğ´Ğ¸Ñ‚Ğµ 2 ÑĞµĞºÑƒĞ½Ğ´Ñ‹ Ğ¿ĞµÑ€ĞµĞ´ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¾Ğ¹ ÑĞ»ĞµĞ´ÑƒÑÑ‰ĞµĞ³Ğ¾ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ.</i>

<b>ğŸ›¡ï¸ Ğ—ĞĞ©Ğ˜Ğ¢Ğ:</b> ĞÑ‚ Ğ¼Ğ°ÑÑĞ¾Ğ²Ğ¾Ğ¹ Ñ€Ğ°ÑÑÑ‹Ğ»ĞºĞ¸
<b>ğŸ¯ Ğ¦Ğ•Ğ›Ğ¬:</b> ĞšĞ¾Ğ¼Ñ„Ğ¾Ñ€Ñ‚Ğ½Ğ¾Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ»Ñ Ğ²ÑĞµÑ…

<i>Ğ¡Ğ¿Ğ°ÑĞ¸Ğ±Ğ¾ Ğ·Ğ° Ñ‚ĞµÑ€Ğ¿ĞµĞ½Ğ¸Ğµ! ğŸ¤—</i>""",
        
        'qr_code': """ğŸ“± <b>Ğ’ĞĞ¨ QR-ĞšĞĞ”</b>

<i>ĞÑ‚ÑĞºĞ°Ğ½Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ ĞºĞ¾Ğ´ Ğ´Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğº Ğ²Ğ°ÑˆĞµĞ¹ ÑÑÑ‹Ğ»ĞºĞµ!</i>

<b>ğŸ”— Ğ¡Ğ¡Ğ«Ğ›ĞšĞ:</b>
<code>{link}</code>

<b>ğŸ“² ĞšĞĞš Ğ˜Ğ¡ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞ¢Ğ¬:</b>
1. <i>Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚Ğµ QR-ĞºĞ¾Ğ´ Ğ² Ğ³Ğ°Ğ»ĞµÑ€ĞµÑ</i>
2. <i>ĞŸĞ¾ĞºĞ°Ğ¶Ğ¸Ñ‚Ğµ Ğ´Ñ€ÑƒĞ·ÑŒÑĞ¼ Ğ´Ğ»Ñ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ</i>
3. <i>Ğ Ğ°Ğ·Ğ¼ĞµÑÑ‚Ğ¸Ñ‚Ğµ Ğ² ÑĞ¾Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… ÑĞµÑ‚ÑÑ…</i>
4. <i>Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒÑ‚Ğµ Ğ½Ğ° Ğ²Ğ¸Ğ·Ğ¸Ñ‚ĞºĞ¸ Ğ¸Ğ»Ğ¸ ÑÑ‚Ğ¸ĞºĞµÑ€Ñ‹</i>

<b>ğŸ¯ ĞŸĞ Ğ•Ğ˜ĞœĞ£Ğ©Ğ•Ğ¡Ğ¢Ğ’Ğ QR:</b>
â€¢ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğ¾Ğ´Ğ½Ğ¸Ğ¼ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼
â€¢ ĞĞµ Ğ½ÑƒĞ¶Ğ½Ğ¾ ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑÑÑ‹Ğ»ĞºÑƒ
â€¢ Ğ¡Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¸ ÑÑ‚Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ²Ğ¸Ğ´
â€¢ ĞŸĞ¾Ğ´Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ´Ğ»Ñ Ğ¿ĞµÑ‡Ğ°Ñ‚Ğ¸

<i>Ğ¡ĞºĞ°Ğ½Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ Ğ¸ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞ¹Ñ‚Ğµ Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ğ¼Ğ³Ğ½Ğ¾Ğ²ĞµĞ½Ğ½Ğ¾! âš¡</i>""",
        
        'support': """ğŸ†˜ <b>Ğ¡Ğ›Ğ£Ğ–Ğ‘Ğ ĞŸĞĞ”Ğ”Ğ•Ğ Ğ–ĞšĞ˜</b>

<i>ĞĞ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ Ğ²Ğ°ÑˆÑƒ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñƒ ĞºĞ°Ğº Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¿Ğ¾Ğ´Ñ€Ğ¾Ğ±Ğ½ĞµĞµ, Ğ¸ Ğ¼Ñ‹ Ğ¿Ğ¾Ğ¼Ğ¾Ğ¶ĞµĞ¼ Ğ²Ğ°Ğ¼ Ğ² ĞºÑ€Ğ°Ñ‚Ñ‡Ğ°Ğ¹ÑˆĞ¸Ğµ ÑÑ€Ğ¾ĞºĞ¸! â°</i>

<b>ğŸ“ Ğ§Ğ¢Ğ Ğ£ĞšĞĞ—ĞĞ¢Ğ¬:</b>
â€¢ Ğ’Ğ°ÑˆÑƒ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñƒ Ğ¸Ğ»Ğ¸ Ğ²Ğ¾Ğ¿Ñ€Ğ¾Ñ
â€¢ ID Ğ²Ğ°ÑˆĞµĞ³Ğ¾ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ° (ĞµÑĞ»Ğ¸ Ğ·Ğ½Ğ°ĞµÑ‚Ğµ)
â€¢ Ğ¡ĞºÑ€Ğ¸Ğ½ÑˆĞ¾Ñ‚ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ)
â€¢ Ğ§Ñ‚Ğ¾ Ğ²Ñ‹ Ğ´ĞµĞ»Ğ°Ğ»Ğ¸ Ğ´Ğ¾ Ğ²Ğ¾Ğ·Ğ½Ğ¸ĞºĞ½Ğ¾Ğ²ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹

<b>ğŸ“ Ğ§Ğ¢Ğ ĞœĞĞ–ĞĞ ĞĞ¢ĞŸĞ ĞĞ’Ğ˜Ğ¢Ğ¬:</b>
â€¢ Ğ¢ĞµĞºÑÑ‚Ğ¾Ğ²Ğ¾Ğµ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ âœï¸
â€¢ Ğ¡ĞºÑ€Ğ¸Ğ½ÑˆĞ¾Ñ‚ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ ğŸ“¸
â€¢ Ğ’Ğ¸Ğ´ĞµĞ¾ Ñ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²ĞµĞ´ĞµĞ½Ğ¸ĞµĞ¼ Ğ±Ğ°Ğ³Ğ° ğŸ¬
â€¢ Ğ›ÑĞ±Ğ¾Ğ¹ Ğ¼ĞµĞ´Ğ¸Ğ°Ñ„Ğ°Ğ¹Ğ» ğŸ“

<b>â° Ğ’Ğ Ğ•ĞœĞ¯ ĞĞ¢Ğ’Ğ•Ğ¢Ğ:</b>
â€¢ ĞĞ±Ñ‹Ñ‡Ğ½Ğ¾: 1-24 Ñ‡Ğ°ÑĞ°
â€¢ Ğ¡Ñ€Ğ¾Ñ‡Ğ½Ñ‹Ğµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹: Ğ±Ñ‹ÑÑ‚Ñ€ĞµĞµ
â€¢ Ğ’Ñ‹Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ: Ğ¼Ğ¾Ğ³ÑƒÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ¸

<i>ĞĞ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñƒ Ğ½Ğ¸Ğ¶Ğµ Ğ¸ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ ğŸ‘‡</i>""",
        
        'support_sent': """âœ… <b>Ğ—ĞĞŸĞ ĞĞ¡ Ğ’ ĞŸĞĞ”Ğ”Ğ•Ğ Ğ–ĞšĞ£ ĞĞ¢ĞŸĞ ĞĞ’Ğ›Ğ•Ğ!</b>

<i>Ğ’Ğ°ÑˆĞµ Ğ¾Ğ±Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğµ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ğ² Ğ½Ğ°ÑˆĞµĞ¹ ÑĞ¸ÑÑ‚ĞµĞ¼Ğµ.</i>

<b>ğŸ“‹ Ğ”ĞĞĞĞ«Ğ• ĞĞ‘Ğ ĞĞ©Ğ•ĞĞ˜Ğ¯:</b>
â€¢ ĞĞ¾Ğ¼ĞµÑ€ Ñ‚Ğ¸ĞºĞµÑ‚Ğ°: <b>#{ticket_id}</b>
â€¢ Ğ’Ñ€ĞµĞ¼Ñ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸: <i>Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‡Ñ‚Ğ¾</i>
â€¢ Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: <b>Ğ’ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞµ</b>

<b>â³ Ğ§Ğ¢Ğ Ğ”ĞĞ›Ğ¬Ğ¨Ğ•:</b>
1. <i>ĞĞ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€ Ñ€Ğ°ÑÑĞ¼Ğ¾Ñ‚Ñ€Ğ¸Ñ‚ Ğ²Ğ°Ñˆ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ</i>
2. <i>Ğ’Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚Ğµ Ğ¾Ñ‚Ğ²ĞµÑ‚ Ğ² ÑÑ‚Ğ¾Ğ¼ Ñ‡Ğ°Ñ‚Ğµ</i>
3. <i>ĞŸÑ€Ğ¸ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ·Ğ°Ğ´Ğ°Ğ´ÑƒÑ‚ ÑƒÑ‚Ğ¾Ñ‡Ğ½ÑÑÑ‰Ğ¸Ğµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹</i>

<b>ğŸ’¡ Ğ¡ĞĞ’Ğ•Ğ¢:</b>
<i>ĞĞµ ÑƒĞ´Ğ°Ğ»ÑĞ¹Ñ‚Ğµ ÑÑ‚Ğ¾Ñ‚ Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğµ Ğ¿Ğ¾Ñ‚ĞµÑ€ÑÑ‚ÑŒ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ¾Ğ±Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ñ!</i>

<i>Ğ¡Ğ¿Ğ°ÑĞ¸Ğ±Ğ¾ Ğ·Ğ° Ğ¾Ğ±Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğµ! ĞœÑ‹ ÑĞ´ĞµĞ»Ğ°ĞµĞ¼ Ğ²ÑÑ‘ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾Ğµ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‡ÑŒ Ğ²Ğ°Ğ¼. ğŸ¤</i>""",
        
        'admin_panel': """ğŸ‘‘ <b>ĞŸĞĞĞ•Ğ›Ğ¬ ĞĞ”ĞœĞ˜ĞĞ˜Ğ¡Ğ¢Ğ ĞĞ¢ĞĞ Ğ</b>

<i>Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² Ñ†ĞµĞ½Ñ‚Ñ€ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ±Ğ¾Ñ‚Ğ¾Ğ¼! Ğ—Ğ´ĞµÑÑŒ Ğ²Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ÑÑ‚ÑŒ Ğ²ÑĞµĞ¼Ğ¸ Ğ°ÑĞ¿ĞµĞºÑ‚Ğ°Ğ¼Ğ¸ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹.</i>

<b>ğŸ“Š Ğ¡Ğ¢ĞĞ¢Ğ˜Ğ¡Ğ¢Ğ˜ĞšĞ Ğ˜ ĞœĞĞĞ˜Ğ¢ĞĞ Ğ˜ĞĞ“:</b>
â€¢ ĞĞ±Ñ‰Ğ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ±Ğ¾Ñ‚Ğ°
â€¢ ĞĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹
â€¢ Ğ“Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸ Ğ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°

<b>ğŸ“¢ Ğ ĞĞ¡Ğ¡Ğ«Ğ›ĞšĞ˜ Ğ˜ Ğ£Ğ’Ğ•Ğ”ĞĞœĞ›Ğ•ĞĞ˜Ğ¯:</b>
â€¢ ĞœĞ°ÑÑĞ¾Ğ²Ñ‹Ğµ Ñ€Ğ°ÑÑÑ‹Ğ»ĞºĞ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
â€¢ Ğ Ğ°ÑÑÑ‹Ğ»ĞºĞ¸ Ñ Ğ¸Ğ½Ğ»Ğ°Ğ¹Ğ½-ĞºĞ½Ğ¾Ğ¿ĞºĞ°Ğ¼Ğ¸
â€¢ Ğ¡ĞµĞ³Ğ¼ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ€Ğ°ÑÑÑ‹Ğ»ĞºĞ¸

<b>ğŸ‘¥ Ğ£ĞŸĞ ĞĞ’Ğ›Ğ•ĞĞ˜Ğ• ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞ¢Ğ•Ğ›Ğ¯ĞœĞ˜:</b>
â€¢ ĞŸĞ¾Ğ¸ÑĞº Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹
â€¢ Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ°/Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ°
â€¢ ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ»Ğ¾Ğ³Ğ¾Ğ² ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
â€¢ Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¸ĞºĞµÑ‚Ğ°Ğ¼Ğ¸ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ¸

<b>ğŸ” Ğ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞ ĞœĞĞ”Ğ•Ğ ĞĞ¦Ğ˜Ğ˜:</b>
â€¢ Ğ—Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ½Ñ‹Ğµ ÑĞ»Ğ¾Ğ²Ğ°
â€¢ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ
â€¢ Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ¾ Ğ½Ğ°Ñ€ÑƒÑˆĞµĞ½Ğ¸ÑÑ…

<b>âš™ï¸ ĞĞĞ¡Ğ¢Ğ ĞĞ™ĞšĞ˜ Ğ‘ĞĞ¢Ğ:</b>
â€¢ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ñ„ÑƒÑ‚ĞµÑ€Ğ°
â€¢ ĞšĞ°Ğ½Ğ°Ğ»Ñ‹ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸
â€¢ ĞšĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ñ‹Ğµ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸
â€¢ ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸

<b>ğŸ’¾ Ğ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞĞ«Ğ• Ğ¤Ğ£ĞĞšĞ¦Ğ˜Ğ˜:</b>
â€¢ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ±ÑĞºĞ°Ğ¿Ğ¾Ğ²
â€¢ Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
â€¢ ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° ĞºÑÑˆĞ°

<i>Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ½ÑƒĞ¶Ğ½Ñ‹Ğ¹ Ñ€Ğ°Ğ·Ğ´ĞµĞ» Ğ½Ğ¸Ğ¶Ğµ ğŸ‘‡</i>""",
        
        'admin_stats': """ğŸ“Š <b>Ğ¡Ğ¢ĞĞ¢Ğ˜Ğ¡Ğ¢Ğ˜ĞšĞ Ğ‘ĞĞ¢Ğ</b>

<i>ĞĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¾ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğµ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ Ğ½Ğ° Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚.</i>

<b>ğŸ‘¥ ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞ¢Ğ•Ğ›Ğ˜:</b>
â”œ Ğ’ÑĞµĞ³Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹: <b>{total_users}</b>
â”œ ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ: <b>{today_active}</b>
â”œ ĞĞ¾Ğ²Ñ‹Ñ… Ğ·Ğ° 24 Ñ‡Ğ°ÑĞ°: <b>{new_users_24h}</b>
â”œ Ğ—Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ…: <b>{blocked_users}</b>
â”” ĞŸÑ€ĞµĞ¼Ğ¸ÑƒĞ¼ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹: <b>{premium_users}</b>

<b>ğŸ“¨ Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ¯:</b>
â”œ Ğ’ÑĞµĞ³Ğ¾ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹: <b>{total_messages}</b>
â”œ Ğ—Ğ° 24 Ñ‡Ğ°ÑĞ°: <b>{messages_24h}</b>
â”œ Ğ£ÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¾: <b>{delivered}</b>
â”œ Ğ—Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ğ¼Ğ¾Ğ´ĞµÑ€Ğ°Ñ†Ğ¸ĞµĞ¹: <b>{blocked_messages}</b>
â”” Ğ¡Ñ€ĞµĞ´Ğ½ĞµĞµ Ğ² Ğ´ĞµĞ½ÑŒ: <b>{avg_daily}</b>

<b>ğŸ“ˆ ĞĞšĞ¢Ğ˜Ğ’ĞĞĞ¡Ğ¢Ğ¬:</b>
â”œ ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… Ğ·Ğ° Ğ½ĞµĞ´ĞµĞ»Ñ: <b>{active_week}</b>
â”œ Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹ Ğ·Ğ° Ğ½ĞµĞ´ĞµĞ»Ñ: <b>{messages_week}</b>
â”œ ĞšĞ¾Ğ½Ğ²ĞµÑ€ÑĞ¸Ñ Ğ² ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ: <b>{conversion}%</b>
â”” Ğ£Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ğµ (30 Ğ´Ğ½ĞµĞ¹): <b>{retention}%</b>

<b>ğŸ†˜ ĞŸĞĞ”Ğ”Ğ•Ğ Ğ–ĞšĞ:</b>
â”œ ĞÑ‚ĞºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ñ‚Ğ¸ĞºĞµÑ‚Ğ¾Ğ²: <b>{open_tickets}</b>
â”œ Ğ ĞµÑˆÑ‘Ğ½Ğ½Ñ‹Ñ… ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ: <b>{solved_today}</b>
â”” Ğ¡Ñ€ĞµĞ´Ğ½ĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°: <b>{avg_response_time}</b>

<b>ğŸ’¾ Ğ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞ:</b>
â”œ Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…: <b>{db_size}</b>
â”œ Ğ’Ñ€ĞµĞ¼Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹: <b>{uptime}</b>
â”œ Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° CPU: <b>{cpu_load}%</b>
â”” Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸: <b>{memory_usage}%</b>

<i>ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½ĞµĞµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ: {last_update}</i>""",
        
        'broadcast_start': """ğŸ“¢ <b>Ğ¡ĞĞ—Ğ”ĞĞĞ˜Ğ• Ğ ĞĞ¡Ğ¡Ğ«Ğ›ĞšĞ˜</b>

<i>ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğµ Ğ±ÑƒĞ´ĞµÑ‚ Ñ€Ğ°Ğ·Ğ¾ÑĞ»Ğ°Ğ½Ğ¾ Ğ²ÑĞµĞ¼ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼ Ğ±Ğ¾Ñ‚Ğ°.</i>

<b>ğŸ“ Ğ¤ĞĞ ĞœĞĞ¢ Ğ¡ĞĞĞ‘Ğ©Ğ•ĞĞ˜Ğ¯:</b>
â€¢ ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ HTML-Ñ€Ğ°Ğ·Ğ¼ĞµÑ‚ĞºĞ°
â€¢ ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑĞ¼Ğ¾Ğ´Ğ·Ğ¸
â€¢ ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ´Ğ»Ğ¸Ğ½Ğ°: 4000 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²

<b>ğŸ“ Ğ§Ğ¢Ğ ĞœĞĞ–ĞĞ ĞĞ¢ĞŸĞ ĞĞ’Ğ˜Ğ¢Ğ¬:</b>
â€¢ Ğ¢ĞµĞºÑÑ‚Ğ¾Ğ²Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ âœï¸
â€¢ Ğ¤Ğ¾Ñ‚Ğ¾ Ñ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑŒÑ ğŸ“¸
â€¢ Ğ’Ğ¸Ğ´ĞµĞ¾ Ñ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸ĞµĞ¼ ğŸ¬
â€¢ Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ Ñ ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸ĞµĞ¼ ğŸ“
â€¢ ĞÑƒĞ´Ğ¸Ğ¾ Ğ¸Ğ»Ğ¸ Ğ³Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²Ğ¾Ğµ ğŸ¤
â€¢ Ğ¡Ñ‚Ğ¸ĞºĞµÑ€ ğŸ˜œ

<b>ğŸ‘¥ ĞĞ£Ğ”Ğ˜Ğ¢ĞĞ Ğ˜Ğ¯:</b>
â€¢ Ğ’ÑĞµ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸
â€¢ Ğ˜ÑĞºĞ»ÑÑ‡Ğ°Ñ Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ…
â€¢ Ğ’ĞºĞ»ÑÑ‡Ğ°Ñ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹

<i>ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ Ğ²Ğ°ÑˆĞµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ´Ğ»Ñ Ñ€Ğ°ÑÑÑ‹Ğ»ĞºĞ¸ Ğ½Ğ¸Ğ¶Ğµ ğŸ‘‡</i>""",
        
        'user_stats': """ğŸ“Š <b>Ğ’Ğ°ÑˆĞ° Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°</b>

<b>ğŸ“ˆ ĞĞ¡ĞĞĞ’ĞĞ«Ğ• ĞœĞ•Ğ¢Ğ Ğ˜ĞšĞ˜:</b>
â”œ ğŸ“¨ ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¾: <b>{received}</b> ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
â”œ ğŸ“¤ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¾: <b>{sent}</b> ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
â”œ ğŸ”— ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¾Ğ²: <b>{clicks}</b> Ñ€Ğ°Ğ·
â”” â±ï¸ Ğ¡Ñ€ĞµĞ´. Ğ¾Ñ‚Ğ²ĞµÑ‚: <b>{response_time}</b>

<b>ğŸ“… ĞĞšĞ¢Ğ˜Ğ’ĞĞĞ¡Ğ¢Ğ¬:</b>
â”œ ğŸ“† Ğ—Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½: <b>{registered}</b>
â”œ ğŸ“… ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½ÑÑ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ: <b>{last_active}</b>
â”” ğŸ• Ğ¡Ñ€ĞµĞ´. Ğ²Ñ€ĞµĞ¼Ñ Ğ² Ğ±Ğ¾Ñ‚Ğµ: <b>{avg_time}</b> Ğ¼Ğ¸Ğ½/Ğ´ĞµĞ½ÑŒ

<b>ğŸ“Š Ğ”Ğ•Ğ¢ĞĞ›Ğ¬ĞĞ:</b>
â”œ ğŸ“ˆ ĞĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ğ¾ Ñ‡Ğ°ÑĞ°Ğ¼: {hours_chart}
â”œ ğŸ“… ĞĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ğ¾ Ğ´Ğ½ÑĞ¼: {days_chart}
â”” ğŸ“ Ğ¢Ğ¸Ğ¿Ñ‹ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹: {types_chart}

<b>ğŸ† Ğ”ĞĞ¡Ğ¢Ğ˜Ğ–Ğ•ĞĞ˜Ğ¯ ({achievements_count}):</b>
{achievements}""",
        
        'user_info': """ğŸ” <b>Ğ˜ĞĞ¤ĞĞ ĞœĞĞ¦Ğ˜Ğ¯ Ğ ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞ¢Ğ•Ğ›Ğ•</b>

<b>ğŸ‘¤ ĞĞ¡ĞĞĞ’ĞĞ«Ğ• Ğ”ĞĞĞĞ«Ğ•:</b>
â”œ ID: <code>{user_id}</code>
â”œ Ğ˜Ğ¼Ñ: <b>{first_name}</b>
â”œ Ğ®Ğ·ĞµÑ€Ğ½ĞµĞ¹Ğ¼: {username}
â”œ Ğ¯Ğ·Ñ‹Ğº: {language}
â”œ ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¾ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹: <b>{received}</b>
â”œ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¾ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹: <b>{sent}</b>
â”œ ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¾Ğ² Ğ¿Ğ¾ ÑÑÑ‹Ğ»ĞºĞµ: <b>{clicks}</b>
â”œ Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ: <b>{registered}</b>
â”” ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½ÑÑ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ: <b>{last_active}</b>

<b>ğŸ“Š Ğ¡Ğ¢ĞĞ¢Ğ˜Ğ¡Ğ¢Ğ˜ĞšĞ ĞĞšĞ¢Ğ˜Ğ’ĞĞĞ¡Ğ¢Ğ˜:</b>
â”œ ğŸ“… ĞĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ·Ğ° Ğ½ĞµĞ´ĞµĞ»Ñ: {activity_week}
â”œ ğŸ“ˆ Ğ¢Ğ¾Ğ¿ ÑĞ»Ğ¾Ğ²: {top_words}
â”” ğŸ”¢ Ğ£Ğ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ñ… ÑĞ»Ğ¾Ğ²: {unique_words}

<b>âš™ï¸ Ğ¡Ğ¢ĞĞ¢Ğ£Ğ¡:</b>
â”œ ĞŸÑ€Ğ¸Ñ‘Ğ¼ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹: {receive_status}
â”” Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ°: {block_status}""",
        
        'logs': "ğŸ“‹ <b>Ğ›Ğ¾Ğ³Ğ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹</b>",
        'no_logs': "ğŸ“‹ <b>Ğ›Ğ¾Ğ³Ğ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹ Ğ¿ÑƒÑÑ‚Ñ‹</b>\n\n<i>ĞŸĞ¾ĞºĞ° Ğ½ĞµÑ‚ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ñ… ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹.</i>",
        'tickets': "ğŸ†˜ <b>ĞÑ‚ĞºÑ€Ñ‹Ñ‚Ñ‹Ğµ Ñ‚Ğ¸ĞºĞµÑ‚Ñ‹</b>",
        'no_tickets': "ğŸ†˜ <b>ĞÑ‚ĞºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ñ‚Ğ¸ĞºĞµÑ‚Ğ¾Ğ² Ğ½ĞµÑ‚</b>\n\n<i>Ğ’ÑĞµ Ğ¾Ğ±Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ñ‹ âœ…</i>",
        'admin_settings': """âš™ï¸ <b>ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ°</b>

<b>ğŸ”” Ğ£Ğ’Ğ•Ğ”ĞĞœĞ›Ğ•ĞĞ˜Ğ¯:</b>
â”œ ĞĞ¾Ğ²Ñ‹Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸: {notify_new_user}
â”œ ĞĞ¾Ğ²Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ: {notify_new_message}
â”” ĞĞ²Ñ‚Ğ¾-Ğ¼Ğ¾Ğ´ĞµÑ€Ğ°Ñ†Ğ¸Ñ: {auto_moderation}

<b>âš¡ ĞŸĞ ĞĞ˜Ğ—Ğ’ĞĞ”Ğ˜Ğ¢Ğ•Ğ›Ğ¬ĞĞĞ¡Ğ¢Ğ¬:</b>
â”œ ĞĞ²Ñ‚Ğ¾-Ğ±ÑĞºĞ°Ğ¿: {auto_backup} Ñ‡Ğ°ÑĞ¾Ğ²
â”œ Ğ›Ğ¸Ğ¼Ğ¸Ñ‚ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹ Ğ² Ğ´ĞµĞ½ÑŒ: {max_messages}
â”” Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…: âœ… Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚

<b>ğŸŒ Ğ¯Ğ—Ğ«Ğš:</b>
â”” Ğ¯Ğ·Ñ‹Ğº Ğ±Ğ¾Ñ‚Ğ°: {language}""",
        
        'direct_message': """âœ‰ï¸ <b>ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ</b> <code>{user_id}</code>

<i>Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸Ğ´Ñ‘Ñ‚ ĞºĞ°Ğº Ğ¾Ñ‚ Ğ±Ğ¾Ñ‚Ğ° ğŸ¤–
ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ‚ĞµĞºÑÑ‚, Ñ„Ğ¾Ñ‚Ğ¾ Ğ¸Ğ»Ğ¸ Ğ²Ğ¸Ğ´ĞµĞ¾.</i>""",
        
        'message_sent_admin': """âœ… <b>Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¾</b>

ğŸ‘¤ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ: <code>{user_id}</code>
ğŸ“ Ğ¢Ğ¸Ğ¿: {message_type}""",
        
        'block_user': "âœ… ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ <code>{user_id}</code> Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½.",
        'unblock_user': "âœ… ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ <code>{user_id}</code> Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½.",
        'user_blocked': "ğŸš« <b>ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½</b>",
        'user_already_blocked': "âœ… ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ ÑƒĞ¶Ğµ Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½",
        'user_not_blocked': "âœ… ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğµ Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½",
        
        'main_menu': "ğŸ  Ğ“Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ Ğ¼ĞµĞ½Ñ",
        'just_now': "Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‡Ñ‚Ğ¾",
        'minutes_ago': "{minutes} Ğ¼Ğ¸Ğ½ÑƒÑ‚ Ğ½Ğ°Ğ·Ğ°Ğ´",
        'hours_ago': "{hours} Ñ‡Ğ°ÑĞ¾Ğ² Ğ½Ğ°Ğ·Ğ°Ğ´",
        'yesterday': "Ğ²Ñ‡ĞµÑ€Ğ°",
        'days_ago': "{days} Ğ´Ğ½ĞµĞ¹ Ğ½Ğ°Ğ·Ğ°Ğ´",
        'never': "Ğ½Ğ¸ĞºĞ¾Ğ³Ğ´Ğ°",
        'send_anonymous_to': "ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ",
        'send_anonymous_description': "ĞĞ°Ğ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ, Ñ„Ğ¾Ñ‚Ğ¾, Ğ²Ğ¸Ğ´ĞµĞ¾ Ğ¸Ğ»Ğ¸ Ğ³Ğ¾Ğ»Ğ¾ÑĞ¾Ğ²Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ",
        'send_reply': "ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ½Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ",
        'reply_to_ticket': "ĞÑ‚Ğ²ĞµÑ‚Ğ¸Ñ‚ÑŒ Ğ½Ğ° Ñ‚Ğ¸ĞºĞµÑ‚",
        'user_blocked_bot': "âŒ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ» Ğ±Ğ¾Ñ‚Ğ°",
        'text': "Ğ¢ĞµĞºÑÑ‚",
        
        'btn_my_link': "ğŸ“© ĞœĞ¾Ñ ÑÑÑ‹Ğ»ĞºĞ°",
        'btn_profile': "ğŸ‘¤ ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ",
        'btn_stats': "ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°",
        'btn_settings': "âš™ï¸ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸",
        'btn_qr': "ğŸ“± QR-ĞºĞ¾Ğ´",
        'btn_help': "â„¹ï¸ ĞŸĞ¾Ğ¼Ğ¾Ñ‰ÑŒ",
        'btn_support': "ğŸ†˜ ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ°",
        'btn_admin': "ğŸ‘‘ ĞĞ´Ğ¼Ğ¸Ğ½",
        'btn_turn_on': "ğŸ”” Ğ’ĞºĞ». ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ",
        'btn_turn_off': "ğŸ”• Ğ’Ñ‹ĞºĞ». ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ",
        'btn_language': "ğŸŒ Ğ¯Ğ·Ñ‹Ğº",
        'btn_back': "â¬…ï¸ ĞĞ°Ğ·Ğ°Ğ´",
        'btn_cancel': "âŒ ĞÑ‚Ğ¼ĞµĞ½Ğ°",
        
        'btn_admin_stats': "ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°",
        'btn_admin_broadcast': "ğŸ“¢ Ğ Ğ°ÑÑÑ‹Ğ»ĞºĞ°",
        'btn_admin_manage_users': "ğŸ‘¥ Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ",
        'btn_admin_find': "ğŸ” ĞĞ°Ğ¹Ñ‚Ğ¸",
        'btn_admin_logs': "ğŸ“‹ Ğ›Ğ¾Ğ³Ğ¸",
        'btn_admin_tickets': "ğŸ†˜ Ğ¢Ğ¸ĞºĞµÑ‚Ñ‹",
        'btn_admin_settings': "âš™ï¸ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸",
        'btn_admin_block': "ğŸš« Ğ‘Ğ»Ğ¾Ğº/Ğ Ğ°Ğ·Ğ±Ğ»Ğ¾Ğº",
        'btn_admin_backup': "ğŸ’¾ Ğ‘ÑĞºĞ°Ğ¿",
        'btn_admin_export': "ğŸ“¤ Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚",
        
        'btn_reply': "ğŸ’Œ ĞÑ‚Ğ²ĞµÑ‚Ğ¸Ñ‚ÑŒ",
        'btn_ignore': "ğŸš« Ğ˜Ğ³Ğ½Ğ¾Ñ€",
        'btn_block': "ğŸš« Ğ—Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ",
        'btn_unblock': "âœ… Ğ Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ",
        'btn_message': "âœ‰ï¸ ĞĞ°Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ ĞµĞ¼Ñƒ",
        'btn_refresh': "ğŸ”„ ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ",
        'btn_toggle_text': "ğŸ”• Ğ¡ĞºÑ€Ñ‹Ñ‚ÑŒ Ñ‚ĞµĞºÑÑ‚",
        'btn_show_text': "ğŸ”” ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ñ‚ĞµĞºÑÑ‚",
        'btn_reply_ticket': "ğŸ“ ĞÑ‚Ğ²ĞµÑ‚Ğ¸Ñ‚ÑŒ",
        'btn_close_ticket': "âœ… Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ",
        
        'block_instruction': "ğŸš« <b>Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ°/Ğ Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ</b>\n\nĞ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ID Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ Ğ¸Ğ»Ğ¸ ÑĞ·ĞµÑ€Ğ½ĞµĞ¹Ğ¼ (Ğ±ĞµĞ· @):",
        'block_success': "âœ… ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ <code>{user_id}</code> Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½.",
        'unblock_success': "âœ… ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ <code>{user_id}</code> Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½.",
        'block_already': "âœ… ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ ÑƒĞ¶Ğµ Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½.",
        'user_not_blocked_msg': "âœ… ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğµ Ğ±Ñ‹Ğ» Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½.",
        
        'file_too_large': "âŒ Ğ¤Ğ°Ğ¹Ğ» ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹ (Ğ¼Ğ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ {max_size}MB).",
        'message_too_long': "âŒ Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ´Ğ»Ğ¸Ğ½Ğ½Ğ¾Ğµ (Ğ¼Ğ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ {max_length} ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²).",
        'rate_limit_exceeded': "â³ Ğ¡Ğ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ². ĞŸĞ¾Ğ´Ğ¾Ğ¶Ğ´Ğ¸Ñ‚Ğµ {seconds} ÑĞµĞºÑƒĞ½Ğ´.",
        'content_blocked': "âŒ Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰Ñ‘Ğ½Ğ½Ñ‹Ğµ ÑĞ»Ğ¾Ğ²Ğ°.",
        'session_expired': "â° Ğ¡ĞµÑÑĞ¸Ñ Ğ¸ÑÑ‚ĞµĞºĞ»Ğ°. ĞĞ°Ñ‡Ğ½Ğ¸Ñ‚Ğµ Ğ·Ğ°Ğ½Ğ¾Ğ²Ğ¾.",
        
        'export_instruction': "ğŸ“¤ <b>Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…</b>\n\n<i>Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ñ‡Ñ‚Ğ¾ ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ:</i>",
        'export_users': "ğŸ‘¥ Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹",
        'export_messages': "ğŸ“¨ Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹",
        'export_stats': "ğŸ“Š Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸",
        'export_processing': "â³ <b>Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…...</b>\n\n<i>ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¿Ğ¾Ğ´Ğ¾Ğ¶Ğ´Ğ¸Ñ‚Ğµ.</i>",
        'export_complete': "âœ… <b>Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½!</b>\n\n<i>Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ñ‹.</i>",
        
        'system_error': "âŒ ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ¾ÑˆĞ»Ğ° ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ğ°Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°. ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¿Ğ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ¿Ğ¾Ğ·Ğ¶Ğµ.",
        'maintenance': "ğŸ”§ Ğ‘Ğ¾Ñ‚ Ğ½Ğ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑÑ Ğ½Ğ° Ñ‚ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¼ Ğ¾Ğ±ÑĞ»ÑƒĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğ¸. ĞŸÑ€Ğ¸Ğ½Ğ¾ÑĞ¸Ğ¼ Ğ¸Ğ·Ğ²Ğ¸Ğ½ĞµĞ½Ğ¸Ñ Ğ·Ğ° Ğ½ĞµÑƒĞ´Ğ¾Ğ±ÑÑ‚Ğ²Ğ°.",
        
        'admin_settings_menu': "âš™ï¸ <b>ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ°</b>\n\n<i>Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¾Ğ¿Ñ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ:</i>",
        'admin_setting_changed': "âœ… ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ°",
        'auto_moderation_on': "âœ… ĞĞ²Ñ‚Ğ¾-Ğ¼Ğ¾Ğ´ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ°",
        'auto_moderation_off': "âŒ ĞĞ²Ñ‚Ğ¾-Ğ¼Ğ¾Ğ´ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ²Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½Ğ°",
        'notify_new_user_on': "âœ… Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ¾ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑÑ… Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹",
        'notify_new_user_off': "âŒ Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ¾ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑÑ… Ğ²Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹",
        'notify_new_message_on': "âœ… Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ¾ Ğ½Ğ¾Ğ²Ñ‹Ñ… ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸ÑÑ… Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹",
        'notify_new_message_off': "âŒ Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ¾ Ğ½Ğ¾Ğ²Ñ‹Ñ… ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸ÑÑ… Ğ²Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹",
        'backup_interval_changed': "âœ… Ğ˜Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ» Ğ°Ğ²Ñ‚Ğ¾-Ğ±ÑĞºĞ°Ğ¿Ğ° Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½",
        'max_messages_changed': "âœ… Ğ›Ğ¸Ğ¼Ğ¸Ñ‚ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹ Ğ² Ğ´ĞµĞ½ÑŒ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½",
        'language_changed_admin': "âœ… Ğ¯Ğ·Ñ‹Ğº Ğ±Ğ¾Ñ‚Ğ° Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½",
        
        'words': "ÑĞ»Ğ¾Ğ²",
        'most_used_words': "Ğ§Ğ°ÑÑ‚Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼Ñ‹Ğµ ÑĞ»Ğ¾Ğ²Ğ°",
        'activity': "ĞĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ",
        'messages': "ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹",
        'active_days': "Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… Ğ´Ğ½ĞµĞ¹",
    },
    
    'en': {
        'start': """ğŸ‰ <b>WELCOME TO ANONY SMS!</b> ğŸ‰

<code>âœ¨ Where secrets come alive and emotions become messages!</code>

<b>ğŸ­ ABSOLUTE ANONYMITY</b>
â€¢ No one will know who sent the message
â€¢ Complete confidentiality guaranteed
â€¢ Only honesty and sincerity

<b>ğŸ”— YOUR UNIQUE LINK:</b>
<code>{link}</code>

<b>ğŸš€ HOW IT WORKS:</b>
1ï¸âƒ£ <i>Share the link with friends</i>
2ï¸âƒ£ <i>They write you anonymous messages</i>
3ï¸âƒ£ <i>You receive secret messages</i>
4ï¸âƒ£ <i>Guess who it could be! ğŸ˜</i>

<b>ğŸ’Œ WHAT YOU CAN SEND:</b>
ğŸ“ Text | ğŸ“¸ Photo | ğŸ¬ Video | ğŸ¤ Voice | ğŸ“ Document | ğŸ˜œ Sticker

<i>Ready to discover the world of secrets? Click the buttons below! ğŸ‘‡</i>""",
        
        'start_ref': """ğŸ¯ <b>YOU FOLLOWED A USER'S LINK!</b>

<i>Now you can send this person a <b>completely anonymous message</b>.</i>

<b>ğŸ”’ YOUR ANONYMITY IS GUARANTEED:</b>
â€¢ The recipient won't see your name
â€¢ Won't know your profile
â€¢ The message will be absolutely anonymous

<b>ğŸ’Œ WHAT YOU CAN SEND:</b>
â€¢ Text message âœï¸
â€¢ Photo or picture ğŸ“¸
â€¢ Video or GIF ğŸ¬
â€¢ Voice message ğŸ¤
â€¢ Any document ğŸ“
â€¢ Funny sticker ğŸ˜œ

<i>Write your message below and click send. The secret will be kept! ğŸ¤«</i>""",
        
        'my_link': """ğŸ”— <b>YOUR PERSONAL LINK FOR ANONYMOUS MESSAGES</b>

<code>{link}</code>

<b>ğŸš€ HOW TO USE:</b>
1. <i>Copy the link above</i>
2. <i>Share in Telegram chats</i>
3. <i>Post in Instagram stories</i>
4. <i>Send to friends on social media</i>
5. <i>Wait for anonymous messages!</i>

<b>ğŸ“ˆ STATISTICS:</b>
â€¢ Link clicks: <b>{clicks}</b>
â€¢ Messages received: <b>{received}</b>

<b>ğŸ’¡ TIP:</b>
<i>The more people follow your link, the more secret confessions and compliments you'll receive! ğŸ˜‰</i>""",
        
        'profile': """ğŸ‘¤ <b>YOUR PROFILE</b>

<b>ğŸ“Š BASIC INFORMATION:</b>
â”œ User ID: <code>{user_id}</code>
â”œ Name: <b>{first_name}</b>
â”œ Username: {username}
â”œ Interface language: {language}
â”œ Registration: <b>{registered}</b>
â”” Last activity: <b>{last_active}</b>

<b>ğŸ“ˆ STATISTICS:</b>
â”œ ğŸ“¨ Messages received: <b>{received}</b>
â”œ ğŸ“¤ Messages sent: <b>{sent}</b>
â”œ ğŸ”— Link clicks: <b>{clicks}</b>
â”” âš™ï¸ Message reception: {receive_status}

<b>ğŸ”— YOUR LINK:</b>
<code>{link}</code>

<i>Share the link with friends to receive more anonymous messages! âœ¨</i>""",
        
        'anonymous_message': """ğŸ“¨ <b>YOU HAVE A NEW ANONYMOUS MESSAGE!</b>

<i>Someone just sent you a secret message... ğŸ‘€</i>

{message_content}

<b>ğŸ”’ SENDER:</b> <i>Unknown</i>
<b>â° TIME:</b> <i>Just now</i>

<i>Want to reply anonymously? Use the "ğŸ’Œ Reply" button below!</i>""",
        
        'message_sent': """âœ… <b>MESSAGE SENT ANONYMOUSLY!</b>

<i>Your message has been successfully delivered to the recipient.</i>

<b>ğŸ¯ STATUS:</b> Delivered
<b>ğŸ”’ ANONYMITY:</b> 100%
<b>ğŸ‘¤ RECIPIENT:</b> Won't know it's you

<i>Want to send another message? Just write it! âœï¸</i>""",
        
        'help': """â“ <b>HELP AND INSTRUCTIONS</b>

<b>ğŸ¯ WHAT IS ANONY SMS?</b>
This is a bot for <b>completely anonymous</b> communication! You can send and receive messages without revealing your identity.

<b>ğŸ“¨ HOW TO RECEIVE MESSAGES:</b>
1. Click the "ğŸ”— My link" button
2. Copy your unique link
3. Share with friends on social media
4. Wait for anonymous messages!

<b>âœ‰ï¸ HOW TO SEND MESSAGES:</b>
1. Follow someone else's link
2. Write a message
3. Send - the recipient won't know it's you!

<b>ğŸ“ WHAT YOU CAN SEND:</b>
âœ… Text messages
âœ… Photos and pictures
âœ… Videos and GIFs
âœ… Voice messages
âœ… Documents and files
âœ… Stickers and emojis

<b>âš™ï¸ SETTINGS:</b>
â€¢ Enable/disable message reception
â€¢ Change interface language
â€¢ View statistics
â€¢ Generate QR code

<b>ğŸ”’ SECURITY:</b>
â€¢ All messages are moderated
â€¢ Protection from spam and insults
â€¢ Confidentiality guaranteed
â€¢ Automatic filtering

<b>ğŸ†˜ SUPPORT:</b>
Having problems? Write to us via the "Support" button!""",
        
        'settings': """âš™ï¸ <b>SETTINGS</b>

<i>Customize the bot to your preferences:</i>

<b>ğŸ”” NOTIFICATIONS:</b>
â€¢ Enable/disable message reception
â€¢ Privacy settings

<b>ğŸŒ LANGUAGE:</b>
â€¢ Russian / English
â€¢ Change interface language

<b>ğŸ”’ SECURITY:</b>
â€¢ Privacy settings
â€¢ User blocking

<i>Select the desired option below ğŸ‘‡</i>""",
        
        'language': """ğŸŒ <b>LANGUAGE SELECTION</b>

<i>Select the bot interface language:</i>

<b>ğŸ‡·ğŸ‡º RUSSIAN</b>
â€¢ Fully in Russian
â€¢ Cyrillic support
â€¢ Localized commands

<b>ğŸ‡ºğŸ‡¸ ENGLISH</b>
â€¢ English interface
â€¢ Full international support
â€¢ Latin alphabet

<i>Click the desired button below ğŸ‘‡</i>""",
        
        'language_changed': """âœ… <b>LANGUAGE CHANGED!</b>

<i>The bot interface is now in {language}.</i>

<b>ğŸ”„ CHANGES:</b>
â€¢ All texts translated
â€¢ Buttons in new language
â€¢ Commands adapted

<i>Enjoy using! âœ¨</i>""",
        
        'support': """ğŸ†˜ <b>SUPPORT SERVICE</b>

<i>Describe your problem in as much detail as possible, and we'll help you as soon as possible! â°</i>

<b>ğŸ“ WHAT TO INCLUDE:</b>
â€¢ Your problem or question
â€¢ Your account ID (if known)
â€¢ Screenshot of the error (if any)
â€¢ What you were doing before the problem occurred

<b>ğŸ“ WHAT YOU CAN SEND:</b>
â€¢ Text description of the problem âœï¸
â€¢ Error screenshot ğŸ“¸
â€¢ Video reproducing the bug ğŸ¬
â€¢ Any media file ğŸ“

<b>â° RESPONSE TIME:</b>
â€¢ Usually: 1-24 hours
â€¢ Urgent issues: faster
â€¢ Weekends: may be delays

<i>Describe the problem below and send the message ğŸ‘‡</i>""",
        
        'support_sent': """âœ… <b>SUPPORT REQUEST SENT!</b>

<i>Your request has been successfully registered in our system.</i>

<b>ğŸ“‹ REQUEST DATA:</b>
â€¢ Ticket number: <b>#{ticket_id}</b>
â€¢ Sending time: <i>Just now</i>
â€¢ Status: <b>Processing</b>

<b>â³ WHAT'S NEXT:</b>
1. <i>Administrator will review your request</i>
2. <i>You will receive a response in this chat</i>
3. <i>Clarifying questions may be asked if necessary</i>

<b>ğŸ’¡ TIP:</b>
<i>Don't delete this dialogue so you don't lose the request history!</i>

<i>Thank you for contacting! We will do our best to help you. ğŸ¤</i>""",
        
        'admin_panel': """ğŸ‘‘ <b>ADMINISTRATOR PANEL</b>

<i>Welcome to the bot control center! Here you can manage all aspects of the system operation.</i>

<b>ğŸ“Š STATISTICS AND MONITORING:</b>
â€¢ General bot statistics
â€¢ User activity
â€¢ Charts and analytics

<b>ğŸ“¢ BROADCASTS AND NOTIFICATIONS:</b>
â€¢ Mass message broadcasts
â€¢ Broadcasts with inline buttons
â€¢ Segmented broadcasts

<b>ğŸ‘¥ USER MANAGEMENT:</b>
â€¢ User search
â€¢ Blocking/unblocking
â€¢ Viewing message logs
â€¢ Support ticket management

<b>ğŸ” MODERATION SYSTEM:</b>
â€¢ Banned words
â€¢ Automatic filtering
â€¢ Violation notifications

<b>âš™ï¸ BOT SETTINGS:</b>
â€¢ Footer settings
â€¢ Subscription channels
â€¢ Custom buttons
â€¢ Basic settings

<b>ğŸ’¾ SYSTEM FUNCTIONS:</b>
â€¢ Creating backups
â€¢ Data export
â€¢ Cache clearing

<i>Select the desired section below ğŸ‘‡</i>""",
        
        'user_stats': """ğŸ“Š <b>Your detailed statistics</b>

<b>ğŸ“ˆ MAIN METRICS:</b>
â”œ ğŸ“¨ Received: <b>{received}</b> messages
â”œ ğŸ“¤ Sent: <b>{sent}</b> messages
â”œ ğŸ”— Clicks: <b>{clicks}</b> times
â”” â±ï¸ Avg. response: <b>{response_time}</b>

<b>ğŸ“… ACTIVITY:</b>
â”œ ğŸ“† Registered: <b>{registered}</b>
â”œ ğŸ“… Last activity: <b>{last_active}</b>
â”” ğŸ• Avg. time in bot: <b>{avg_time}</b> min/day

<b>ğŸ“Š DETAILED:</b>
â”œ ğŸ“ˆ Activity by hour: {hours_chart}
â”œ ğŸ“… Activity by day: {days_chart}
â”” ğŸ“ Message types: {types_chart}

<b>ğŸ† ACHIEVEMENTS ({achievements_count}):</b>
{achievements}""",
        
        'admin_stats': """ğŸ‘‘ <b>Bot Statistics</b>

<b>ğŸ“Š MAIN METRICS:</b>
â”œ Total users: <b>{total_users}</b>
â”œ Active today: <b>{today_active}</b>
â”œ Total messages: <b>{total_messages}</b>
â”œ Messages in 24h: <b>{messages_24h}</b>
â”œ New in 24h: <b>{new_users_24h}</b>
â”œ Blocked: <b>{blocked_users}</b>
â”œ Open tickets: <b>{open_tickets}</b>
â”” Avg. activity per hour: <b>{avg_hourly}</b>

<b>ğŸ“ˆ DETAILED STATISTICS:</b>
â”œ Users this week: <b>{users_week}</b>
â”œ Messages this week: <b>{messages_week}</b>
â”œ Active this week: <b>{active_week}</b>
â”œ Retention (30 days): <b>{retention_30d}%</b>
â”” Conversion to messages: <b>{conversion_rate}%</b>""",
        
        'broadcast_start': """ğŸ“¢ <b>Create Broadcast</b>

<i>Send a message that will be sent to all users.</i>

<b>ğŸ“ Can send:</b>
â€¢ Text with HTML markup âœï¸
â€¢ Photo with caption ğŸ“¸
â€¢ Video with description ğŸ¬
â€¢ Document with comment ğŸ“
â€¢ Sticker ğŸ˜œ""",
        
        'user_info': """ğŸ” <b>USER INFORMATION</b>

<b>ğŸ‘¤ BASIC DATA:</b>
â”œ ID: <code>{user_id}</code>
â”œ Name: <b>{first_name}</b>
â”œ Username: {username}
â”œ Language: {language}
â”œ Messages received: <b>{received}</b>
â”œ Messages sent: <b>{sent}</b>
â”œ Link clicks: <b>{clicks}</b>
â”œ Registered: {registered}
â”” Last activity: {last_active}

<b>ğŸ“Š ACTIVITY STATISTICS:</b>
â”œ ğŸ“… Activity this week: {activity_week}
â”œ ğŸ“ˆ Top words: {top_words}
â”” ğŸ”¢ Unique words: {unique_words}

<b>âš™ï¸ STATUS:</b>
â”œ Receive messages: {receive_status}
â”” Blocked: {block_status}""",
        
        'logs': "ğŸ“‹ <b>Message logs</b>",
        'no_logs': "ğŸ“‹ <b>Message logs are empty</b>\n\n<i>No messages sent yet.</i>",
        'tickets': "ğŸ†˜ <b>Open tickets</b>",
        'no_tickets': "ğŸ†˜ <b>No open tickets</b>\n\n<i>All requests processed âœ…</i>",
        'admin_settings': """âš™ï¸ <b>Administrator Settings</b>

<b>ğŸ”” NOTIFICATIONS:</b>
â”œ New users: {notify_new_user}
â”œ New messages: {notify_new_message}
â”” Auto-moderation: {auto_moderation}

<b>âš¡ PERFORMANCE:</b>
â”œ Auto-backup: {auto_backup} hours
â”œ Daily message limit: {max_messages}
â”” Database: âœ… Working

<b>ğŸŒ LANGUAGE:</b>
â”” Bot language: {language}""",
        
        'direct_message': """âœ‰ï¸ <b>Send message for user</b> <code>{user_id}</code>

<i>The message will come from the bot ğŸ¤–
You can send text, photo or video.</i>""",
        
        'message_sent_admin': """âœ… <b>Message sent</b>

ğŸ‘¤ User: <code>{user_id}</code>
ğŸ“ Type: {message_type}""",
        
        'block_user': "âœ… User <code>{user_id}</code> blocked.",
        'unblock_user': "âœ… User <code>{user_id}</code> unblocked.",
        'user_blocked': "ğŸš« <b>User blocked</b>",
        'user_already_blocked': "âœ… User already blocked",
        'user_not_blocked': "âœ… User not blocked",
        
        'main_menu': "ğŸ  Main menu",
        'just_now': "just now",
        'minutes_ago': "{minutes} minutes ago",
        'hours_ago': "{hours} hours ago",
        'yesterday': "yesterday",
        'days_ago': "{days} days ago",
        'never': "never",
        'send_anonymous_to': "Send anonymous message",
        'send_anonymous_description': "Write a message, photo, video or voice message",
        'send_reply': "Send reply message",
        'reply_to_ticket': "Reply to ticket",
        'user_blocked_bot': "âŒ User blocked the bot",
        'text': "Text",
        
        'btn_my_link': "ğŸ“© My link",
        'btn_profile': "ğŸ‘¤ Profile",
        'btn_stats': "ğŸ“Š Statistics",
        'btn_settings': "âš™ï¸ Settings",
        'btn_qr': "ğŸ“± QR code",
        'btn_help': "â„¹ï¸ Help",
        'btn_support': "ğŸ†˜ Support",
        'btn_admin': "ğŸ‘‘ Admin",
        'btn_turn_on': "ğŸ”” Enable messages",
        'btn_turn_off': "ğŸ”• Disable messages",
        'btn_language': "ğŸŒ Language",
        'btn_back': "â¬…ï¸ Back",
        'btn_cancel': "âŒ Cancel",
        
        'btn_admin_stats': "ğŸ“Š Statistics",
        'btn_admin_broadcast': "ğŸ“¢ Broadcast",
        'btn_admin_manage_users': "ğŸ‘¥ Manage",
        'btn_admin_find': "ğŸ” Find",
        'btn_admin_logs': "ğŸ“‹ Logs",
        'btn_admin_tickets': "ğŸ†˜ Tickets",
        'btn_admin_settings': "âš™ï¸ Settings",
        'btn_admin_block': "ğŸš« Block/Unblock",
        'btn_admin_backup': "ğŸ’¾ Backup",
        'btn_admin_export': "ğŸ“¤ Export",
        
        'btn_reply': "ğŸ’Œ Reply",
        'btn_ignore': "ğŸš« Ignore",
        'btn_block': "ğŸš« Block",
        'btn_unblock': "âœ… Unblock",
        'btn_message': "âœ‰ï¸ Message",
        'btn_refresh': "ğŸ”„ Refresh",
        'btn_toggle_text': "ğŸ”• Hide text",
        'btn_show_text': "ğŸ”” Show text",
        'btn_reply_ticket': "ğŸ“ Reply",
        'btn_close_ticket': "âœ… Close",
        
        'block_instruction': "ğŸš« <b>Block/Unblock user</b>\n\nEnter user ID or username (without @):",
        'block_success': "âœ… User <code>{user_id}</code> blocked.",
        'unblock_success': "âœ… User <code>{user_id}</code> unblocked.",
        'block_already': "âœ… User already blocked.",
        'user_not_blocked_msg': "âœ… User was not blocked.",
        
        'file_too_large': "âŒ File is too large (maximum {max_size}MB).",
        'message_too_long': "âŒ Message is too long (maximum {max_length} characters).",
        'rate_limit_exceeded': "â³ Too many requests. Wait {seconds} seconds.",
        'content_blocked': "âŒ Message contains forbidden words.",
        'session_expired': "â° Session expired. Start over.",
        
        'export_instruction': "ğŸ“¤ <b>Export data</b>\n\n<i>Choose what to export:</i>",
        'export_users': "ğŸ‘¥ Export users",
        'export_messages': "ğŸ“¨ Export messages",
        'export_stats': "ğŸ“Š Export statistics",
        'export_processing': "â³ <b>Exporting data...</b>\n\n<i>Please wait.</i>",
        'export_complete': "âœ… <b>Export completed!</b>\n\n<i>Data successfully saved.</i>",
        
        'system_error': "âŒ A system error occurred. Please try again later.",
        'maintenance': "ğŸ”§ The bot is under maintenance. We apologize for the inconvenience.",
        
        'admin_settings_menu': "âš™ï¸ <b>Administrator Settings</b>\n\n<i>Select an option to change:</i>",
        'admin_setting_changed': "âœ… Setting changed",
        'auto_moderation_on': "âœ… Auto-moderation enabled",
        'auto_moderation_off': "âŒ Auto-moderation disabled",
        'notify_new_user_on': "âœ… New user notifications enabled",
        'notify_new_user_off': "âŒ New user notifications disabled",
        'notify_new_message_on': "âœ… New message notifications enabled",
        'notify_new_message_off': "âŒ New message notifications disabled",
        'backup_interval_changed': "âœ… Auto-backup interval changed",
        'max_messages_changed': "âœ… Daily message limit changed",
        'language_changed_admin': "âœ… Bot language changed",
        
        'words': "words",
        'most_used_words': "Most used words",
        'activity': "Activity",
        'messages': "messages",
        'active_days': "active days",
    }
}

def get_text(lang, key, **kwargs):
    if lang not in TEXTS:
        lang = 'ru'
    if key not in TEXTS[lang]:
        if 'ru' in TEXTS and key in TEXTS['ru']:
            text = TEXTS['ru'][key]
        else:
            return f"[{key}]"
    else:
        text = TEXTS[lang][key]
    
    return text.format(**kwargs) if kwargs else text

def format_time(timestamp, lang='ru'):
    if not timestamp:
        return get_text(lang, 'never')
    
    dt = datetime.fromtimestamp(timestamp)
    now = datetime.now()
    diff = now - dt
    
    if diff.days == 0:
        if diff.seconds < 60:
            return get_text(lang, 'just_now')
        elif diff.seconds < 3600:
            minutes = diff.seconds // 60
            return get_text(lang, 'minutes_ago', minutes=minutes)
        else:
            hours = diff.seconds // 3600
            return get_text(lang, 'hours_ago', hours=hours)
    elif diff.days == 1:
        return get_text(lang, 'yesterday')
    else:
        return dt.strftime("%d.%m.%Y %H:%M")

def check_rate_limit(user_id):
    now = time.time()
    minute = int(now // 60)
    
    if user_id not in rate_limit_cache:
        rate_limit_cache[user_id] = {'minute': minute, 'count': 1}
        return True, 0
    
    if rate_limit_cache[user_id]['minute'] != minute:
        rate_limit_cache[user_id] = {'minute': minute, 'count': 1}
        return True, 0
    
    rate_limit_cache[user_id]['count'] += 1
    if rate_limit_cache[user_id]['count'] > MAX_REQUESTS_PER_MINUTE:
        wait_time = 60 - (now % 60)
        return False, int(wait_time)
    
    return True, 0

def check_spam(user_id):
    current_time = time.time()
    last_time = message_cooldown.get(user_id, 0)
    
    if current_time - last_time < ANTISPAM_INTERVAL:
        return False
    
    message_cooldown[user_id] = current_time
    return True

def check_session_timeout(user_id):
    if user_id not in session_timestamps:
        session_timestamps[user_id] = time.time()
        return True
    
    if time.time() - session_timestamps[user_id] > SESSION_TIMEOUT:
        if user_id in user_sessions:
            del user_sessions[user_id]
        if user_id in admin_modes:
            del admin_modes[user_id]
        session_timestamps[user_id] = time.time()
        return False
    
    session_timestamps[user_id] = time.time()
    return True

def check_content_moderation(text):
    if not text:
        return True
    
    if not admin_settings['auto_moderation']:
        return True
    
    text_lower = text.lower()
    for word in BLACKLIST_WORDS:
        if word in text_lower:
            return False
    return True

def extract_words(text):
    if not text:
        return []
    
    words = re.findall(r'\b[Ğ°-Ña-z]{3,}\b', text.lower())
    return words

def get_top_words(user_id, limit=5):
    try:
        with db.get_connection() as conn:
            c = conn.cursor()
            c.execute('SELECT text FROM messages WHERE sender_id = ? AND text IS NOT NULL', (user_id,))
            rows = c.fetchall()
            
            all_words = []
            for row in rows:
                words = extract_words(row['text'])
                all_words.extend(words)
            
            word_count = collections.Counter(all_words)
            return word_count.most_common(limit)
    except:
        return []

def get_user_activity_stats(user_id):
    try:
        with db.get_connection() as conn:
            c = conn.cursor()
            
            week_ago = int(time.time()) - 7 * 86400
            c.execute('SELECT COUNT(*) FROM messages WHERE sender_id = ? AND timestamp > ?', 
                     (user_id, week_ago))
            messages_week = c.fetchone()[0]
            
            c.execute('SELECT COUNT(DISTINCT date(timestamp, "unixepoch")) FROM messages WHERE sender_id = ?', 
                     (user_id,))
            active_days = c.fetchone()[0]
            
            c.execute('SELECT text FROM messages WHERE sender_id = ? AND text IS NOT NULL', (user_id,))
            rows = c.fetchall()
            
            all_words = []
            for row in rows:
                words = extract_words(row['text'])
                all_words.extend(words)
            
            unique_words = len(set(all_words))
            
            return {
                'messages_week': messages_week,
                'active_days': active_days,
                'unique_words': unique_words
            }
    except:
        return {'messages_week': 0, 'active_days': 0, 'unique_words': 0}

def generate_link(user_id):
    try:
        bot_username = bot.get_me().username
        return f"https://t.me/{bot_username}?start={user_id}"
    except:
        return f"https://t.me/{bot.get_me().username}?start={user_id}"

def main_keyboard(is_admin=False, lang='ru'):
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
    
    buttons = [
        types.KeyboardButton(get_text(lang, 'btn_my_link')),
        types.KeyboardButton(get_text(lang, 'btn_profile')),
        types.KeyboardButton(get_text(lang, 'btn_stats')),
        types.KeyboardButton(get_text(lang, 'btn_settings')),
        types.KeyboardButton(get_text(lang, 'btn_qr')),
        types.KeyboardButton(get_text(lang, 'btn_help')),
        types.KeyboardButton(get_text(lang, 'btn_support')),
        types.KeyboardButton(get_text(lang, 'btn_language'))
    ]
    
    if is_admin:
        buttons.append(types.KeyboardButton(get_text(lang, 'btn_admin')))
    
    keyboard.add(*buttons)
    return keyboard

def settings_keyboard(lang='ru'):
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
    buttons = [
        types.KeyboardButton(get_text(lang, 'btn_turn_on')),
        types.KeyboardButton(get_text(lang, 'btn_turn_off')),
        types.KeyboardButton(get_text(lang, 'btn_language')),
        types.KeyboardButton(get_text(lang, 'btn_back'))
    ]
    keyboard.add(*buttons)
    return keyboard

def admin_keyboard(lang='ru'):
    keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True, row_width=2)
    buttons = [
        types.KeyboardButton(get_text(lang, 'btn_admin_stats')),
        types.KeyboardButton(get_text(lang, 'btn_admin_broadcast')),
        types.KeyboardButton(get_text(lang, 'btn_admin_find')),
        types.KeyboardButton(get_text(lang, 'btn_admin_logs')),
        types.KeyboardButton(get_text(lang, 'btn_admin_tickets')),
        types.KeyboardButton(get_text(lang, 'btn_admin_settings')),
        types.KeyboardButton(get_text(lang, 'btn_admin_block')),
        types.KeyboardButton(get_text(lang, 'btn_admin_backup')),
        types.KeyboardButton(get_text(lang, 'btn_admin_export')),
        types.KeyboardButton(get_text(lang, 'btn_back'))
    ]
    keyboard.add(*buttons)
    return keyboard

def admin_settings_keyboard(lang='ru'):
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    
    auto_mod_status = "âœ…" if admin_settings['auto_moderation'] else "âŒ"
    notify_user_status = "âœ…" if admin_settings['notify_admin_new_user'] else "âŒ"
    notify_message_status = "âœ…" if admin_settings['notify_admin_new_message'] else "âŒ"
    
    keyboard.add(
        types.InlineKeyboardButton(f"{auto_mod_status} ĞĞ²Ñ‚Ğ¾-Ğ¼Ğ¾Ğ´ĞµÑ€Ğ°Ñ†Ğ¸Ñ", 
                                 callback_data="toggle_auto_moderation"),
        types.InlineKeyboardButton(f"{notify_user_status} Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼. Ğ¾ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑÑ…", 
                                 callback_data="toggle_notify_new_user"),
        types.InlineKeyboardButton(f"{notify_message_status} Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼. Ğ¾ Ğ½Ğ¾Ğ²Ñ‹Ñ… ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸ÑÑ…", 
                                 callback_data="toggle_notify_new_message"),
        types.InlineKeyboardButton("ğŸ• Ğ˜Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ» Ğ°Ğ²Ñ‚Ğ¾-Ğ±ÑĞºĞ°Ğ¿Ğ°", 
                                 callback_data="change_backup_interval"),
        types.InlineKeyboardButton("ğŸ“¨ Ğ›Ğ¸Ğ¼Ğ¸Ñ‚ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹ Ğ² Ğ´ĞµĞ½ÑŒ", 
                                 callback_data="change_max_messages"),
        types.InlineKeyboardButton("ğŸŒ Ğ¯Ğ·Ñ‹Ğº Ğ±Ğ¾Ñ‚Ğ°", 
                                 callback_data="change_bot_language"),
        types.InlineKeyboardButton("â¬…ï¸ ĞĞ°Ğ·Ğ°Ğ´", callback_data="admin_back")
    )
    
    return keyboard

def cancel_keyboard(lang='ru'):
    return types.ReplyKeyboardMarkup(resize_keyboard=True).add(get_text(lang, 'btn_cancel'))

def language_keyboard():
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    keyboard.add(
        types.InlineKeyboardButton("ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹", callback_data="lang_ru"),
        types.InlineKeyboardButton("ğŸ‡ºğŸ‡¸ English", callback_data="lang_en")
    )
    return keyboard

def bot_language_keyboard():
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    keyboard.add(
        types.InlineKeyboardButton("ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹", callback_data="bot_lang_ru"),
        types.InlineKeyboardButton("ğŸ‡ºğŸ‡¸ English", callback_data="bot_lang_en"),
        types.InlineKeyboardButton("â¬…ï¸ ĞĞ°Ğ·Ğ°Ğ´", callback_data="admin_settings_back")
    )
    return keyboard

def backup_interval_keyboard():
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    keyboard.add(
        types.InlineKeyboardButton("1 Ñ‡Ğ°Ñ", callback_data="backup_1"),
        types.InlineKeyboardButton("6 Ñ‡Ğ°ÑĞ¾Ğ²", callback_data="backup_6"),
        types.InlineKeyboardButton("12 Ñ‡Ğ°ÑĞ¾Ğ²", callback_data="backup_12"),
        types.InlineKeyboardButton("24 Ñ‡Ğ°ÑĞ°", callback_data="backup_24"),
        types.InlineKeyboardButton("48 Ñ‡Ğ°ÑĞ¾Ğ²", callback_data="backup_48"),
        types.InlineKeyboardButton("â¬…ï¸ ĞĞ°Ğ·Ğ°Ğ´", callback_data="admin_settings_back")
    )
    return keyboard

def max_messages_keyboard():
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    keyboard.add(
        types.InlineKeyboardButton("50", callback_data="max_50"),
        types.InlineKeyboardButton("100", callback_data="max_100"),
        types.InlineKeyboardButton("200", callback_data="max_200"),
        types.InlineKeyboardButton("500", callback_data="max_500"),
        types.InlineKeyboardButton("1000", callback_data="max_1000"),
        types.InlineKeyboardButton("â¬…ï¸ ĞĞ°Ğ·Ğ°Ğ´", callback_data="admin_settings_back")
    )
    return keyboard

def get_message_reply_keyboard(message_id, lang='ru'):
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    keyboard.add(
        types.InlineKeyboardButton(get_text(lang, 'btn_reply'), callback_data=f"reply_{message_id}"),
        types.InlineKeyboardButton(get_text(lang, 'btn_ignore'), callback_data="ignore")
    )
    return keyboard

def get_admin_ticket_keyboard(ticket_id, user_id, lang='ru'):
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    keyboard.add(
        types.InlineKeyboardButton(get_text(lang, 'btn_reply_ticket'), callback_data=f"support_reply_{ticket_id}"),
        types.InlineKeyboardButton(get_text(lang, 'btn_close_ticket'), callback_data=f"support_close_{ticket_id}")
    )
    keyboard.add(
        types.InlineKeyboardButton(get_text(lang, 'btn_profile'), callback_data=f"admin_user_{user_id}"),
        types.InlineKeyboardButton(get_text(lang, 'btn_block'), callback_data=f"admin_block_{user_id}")
    )
    return keyboard

def get_admin_user_keyboard(user_id, is_blocked, lang='ru'):
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    if is_blocked:
        keyboard.add(
            types.InlineKeyboardButton(get_text(lang, 'btn_unblock'), callback_data=f"admin_unblock_{user_id}"),
            types.InlineKeyboardButton(get_text(lang, 'btn_message'), callback_data=f"admin_msg_{user_id}")
        )
    else:
        keyboard.add(
            types.InlineKeyboardButton(get_text(lang, 'btn_block'), callback_data=f"admin_block_{user_id}"),
            types.InlineKeyboardButton(get_text(lang, 'btn_message'), callback_data=f"admin_msg_{user_id}")
        )
    return keyboard

def get_admin_log_keyboard(show_text, lang='ru'):
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    keyboard.add(
        types.InlineKeyboardButton(get_text(lang, 'btn_refresh'), callback_data="refresh_logs"),
        types.InlineKeyboardButton(get_text(lang, 'btn_hide_text') if show_text else get_text(lang, 'btn_show_text'), 
                                 callback_data="toggle_text")
    )
    return keyboard

def export_keyboard(lang='ru'):
    keyboard = types.InlineKeyboardMarkup(row_width=2)
    keyboard.add(
        types.InlineKeyboardButton(get_text(lang, 'export_users'), callback_data="export_users"),
        types.InlineKeyboardButton(get_text(lang, 'export_messages'), callback_data="export_messages"),
        types.InlineKeyboardButton(get_text(lang, 'export_stats'), callback_data="export_stats"),
        types.InlineKeyboardButton(get_text(lang, 'btn_cancel'), callback_data="export_cancel")
    )
    return keyboard

class Database:
    def __init__(self, db_path=DB_PATH):
        self.db_path = db_path
        self._stats_cache = {}
        self._stats_cache_time = {}
        self._user_cache = {}
        self._user_cache_time = {}
        self.init_db()
    
    @contextmanager
    def get_connection(self):
        conn = sqlite3.connect(self.db_path, check_same_thread=False)
        conn.row_factory = sqlite3.Row
        conn.execute('PRAGMA journal_mode=WAL')
        conn.execute('PRAGMA synchronous=NORMAL')
        try:
            yield conn
            conn.commit()
        except Exception as e:
            conn.rollback()
            logger.error(f"DB error: {e}")
            raise
        finally:
            conn.close()
    
    def init_db(self):
        with self.get_connection() as conn:
            c = conn.cursor()
            
            c.execute('''
                CREATE TABLE IF NOT EXISTS users (
                    user_id INTEGER PRIMARY KEY,
                    username TEXT,
                    first_name TEXT,
                    language TEXT DEFAULT 'ru',
                    created_at INTEGER,
                    last_active INTEGER,
                    messages_received INTEGER DEFAULT 0,
                    messages_sent INTEGER DEFAULT 0,
                    link_clicks INTEGER DEFAULT 0,
                    receive_messages INTEGER DEFAULT 1,
                    is_premium INTEGER DEFAULT 0,
                    is_blocked INTEGER DEFAULT 0
                )
            ''')
            
            c.execute('''
                CREATE TABLE IF NOT EXISTS messages (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    sender_id INTEGER,
                    receiver_id INTEGER,
                    message_type TEXT,
                    text TEXT,
                    file_id TEXT,
                    file_unique_id TEXT,
                    file_size INTEGER,
                    timestamp INTEGER,
                    replied_to INTEGER DEFAULT 0,
                    is_read INTEGER DEFAULT 0,
                    moderated INTEGER DEFAULT 1
                )
            ''')
            
            c.execute('''
                CREATE TABLE IF NOT EXISTS support_tickets (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    user_id INTEGER,
                    message TEXT,
                    file_id TEXT,
                    file_unique_id TEXT,
                    message_type TEXT,
                    status TEXT DEFAULT 'open',
                    created_at INTEGER,
                    admin_id INTEGER,
                    admin_reply TEXT,
                    replied_at INTEGER,
                    priority INTEGER DEFAULT 1
                )
            ''')
            
            c.execute('''
                CREATE TABLE IF NOT EXISTS user_history (
                    user_id INTEGER,
                    partner_id INTEGER,
                    message_id INTEGER,
                    direction TEXT,
                    timestamp INTEGER,
                    preview TEXT,
                    PRIMARY KEY (user_id, message_id)
                )
            ''')
            
            c.execute('CREATE INDEX IF NOT EXISTS idx_messages_sender ON messages(sender_id)')
            c.execute('CREATE INDEX IF NOT EXISTS idx_messages_receiver ON messages(receiver_id)')
            c.execute('CREATE INDEX IF NOT EXISTS idx_messages_timestamp ON messages(timestamp)')
            c.execute('CREATE INDEX IF NOT EXISTS idx_users_last_active ON users(last_active)')
            c.execute('CREATE INDEX IF NOT EXISTS idx_tickets_status ON support_tickets(status)')
            
            logger.info("Database initialized")
    
    def _get_cached_user(self, user_id):
        now = time.time()
        if user_id in self._user_cache:
            if now - self._user_cache_time.get(user_id, 0) < 60:
                return self._user_cache[user_id]
        
        with self.get_connection() as conn:
            c = conn.cursor()
            c.execute('SELECT * FROM users WHERE user_id = ?', (user_id,))
            row = c.fetchone()
            user = dict(row) if row else None
            
            if user:
                self._user_cache[user_id] = user
                self._user_cache_time[user_id] = now
            
            return user
    
    def _get_cached_user_by_username(self, username):
        now = time.time()
        cache_key = f"username:{username}"
        
        if cache_key in self._user_cache:
            if now - self._user_cache_time.get(cache_key, 0) < 60:
                return self._user_cache[cache_key]
        
        with self.get_connection() as conn:
            c = conn.cursor()
            c.execute('SELECT * FROM users WHERE username = ?', (username,))
            row = c.fetchone()
            user = dict(row) if row else None
            
            if user:
                self._user_cache[cache_key] = user
                self._user_cache_time[cache_key] = now
            
            return user
    
    def get_user(self, user_id):
        return self._get_cached_user(user_id)
    
    def get_user_by_username(self, username):
        return self._get_cached_user_by_username(username)
    
    def _clear_user_cache(self, user_id=None, username=None):
        if user_id:
            if user_id in self._user_cache:
                del self._user_cache[user_id]
            if user_id in self._user_cache_time:
                del self._user_cache_time[user_id]
        
        if username:
            cache_key = f"username:{username}"
            if cache_key in self._user_cache:
                del self._user_cache[cache_key]
            if cache_key in self._user_cache_time:
                del self._user_cache_time[cache_key]
    
    def get_admin_stats(self):
        now = time.time()
        if 'admin_stats' in self._stats_cache:
            if now - self._stats_cache_time.get('admin_stats', 0) < 60:
                return self._stats_cache['admin_stats']
        
        stats = self._get_admin_stats_impl()
        self._stats_cache['admin_stats'] = stats
        self._stats_cache_time['admin_stats'] = now
        return stats
    
    def _get_admin_stats_impl(self):
        with self.get_connection() as conn:
            c = conn.cursor()
            
            c.execute('SELECT COUNT(*) FROM users')
            total_users = c.fetchone()[0]
            
            c.execute('SELECT COUNT(*) FROM messages')
            total_messages = c.fetchone()[0]
            
            c.execute('SELECT COUNT(*) FROM users WHERE is_blocked = 1')
            blocked_users = c.fetchone()[0]
            
            c.execute('SELECT COUNT(*) FROM support_tickets WHERE status = "open"')
            open_tickets = c.fetchone()[0]
            
            today_start = int(time.time()) - 86400
            c.execute('SELECT COUNT(DISTINCT user_id) FROM users WHERE last_active > ?', (today_start,))
            today_active = c.fetchone()[0]
            
            c.execute('SELECT COUNT(*) FROM messages WHERE timestamp > ?', 
                     (int(time.time()) - 86400,))
            messages_24h = c.fetchone()[0]
            
            c.execute('SELECT COUNT(*) FROM users WHERE created_at > ?', 
                     (int(time.time()) - 86400,))
            new_users_24h = c.fetchone()[0]
            
            c.execute('SELECT COUNT(*) / 24.0 FROM messages WHERE timestamp > ?', 
                     (int(time.time()) - 86400,))
            avg_hourly_result = c.fetchone()[0]
            avg_hourly = round(avg_hourly_result, 2) if avg_hourly_result else 0
            
            c.execute('SELECT COUNT(*) FROM users WHERE created_at > ?', 
                     (int(time.time()) - 604800,))
            users_week = c.fetchone()[0]
            
            c.execute('SELECT COUNT(*) FROM messages WHERE timestamp > ?', 
                     (int(time.time()) - 604800,))
            messages_week = c.fetchone()[0]
            
            c.execute('SELECT COUNT(DISTINCT user_id) FROM messages WHERE timestamp > ?', 
                     (int(time.time()) - 604800,))
            active_week = c.fetchone()[0]
            
            c.execute('SELECT COUNT(DISTINCT user_id) FROM messages WHERE timestamp > ?', 
                     (int(time.time()) - 2592000,))
            active_30d = c.fetchone()[0]
            
            c.execute('SELECT COUNT(*) FROM users WHERE created_at < ?', 
                     (int(time.time()) - 2592000,))
            old_users = c.fetchone()[0]
            
            retention_30d = round((active_30d / old_users * 100), 2) if old_users > 0 else 100
            
            c.execute('SELECT COUNT(DISTINCT sender_id) FROM messages')
            users_with_messages = c.fetchone()[0]
            
            conversion_rate = round((users_with_messages / total_users * 100), 2) if total_users > 0 else 0
            
            return {
                'total_users': total_users,
                'total_messages': total_messages,
                'blocked_users': blocked_users,
                'open_tickets': open_tickets,
                'today_active': today_active,
                'messages_24h': messages_24h,
                'new_users_24h': new_users_24h,
                'avg_hourly': avg_hourly,
                'users_week': users_week,
                'messages_week': messages_week,
                'active_week': active_week,
                'retention_30d': retention_30d,
                'conversion_rate': conversion_rate
            }
    
    def register_user(self, user_id, username, first_name):
        with self.get_connection() as conn:
            c = conn.cursor()
            now = int(time.time())
            
            c.execute('''
                INSERT OR IGNORE INTO users 
                (user_id, username, first_name, created_at, last_active) 
                VALUES (?, ?, ?, ?, ?)
            ''', (user_id, username, first_name, now, now))
            
            c.execute('''
                UPDATE users SET 
                username = ?, 
                first_name = ?,
                last_active = ?
                WHERE user_id = ?
            ''', (username, first_name, now, user_id))
            
            self._clear_user_cache(user_id, username)
            
            if admin_settings['notify_admin_new_user']:
                try:
                    notification = f"""ğŸ‘¤ ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ

ID: <code>{user_id}</code>
Ğ˜Ğ¼Ñ: {first_name}
Ğ®Ğ·ĞµÑ€Ğ½ĞµĞ¹Ğ¼: {f'@{username}' if username else 'Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚'}
Ğ’Ñ€ĞµĞ¼Ñ: {format_time(now, 'ru')}

Ğ’ÑĞµĞ³Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹: {self.get_admin_stats()['total_users']}"""
                    
                    bot.send_message(ADMIN_ID, notification, parse_mode="HTML")
                except:
                    pass
    
    def update_last_active(self, user_id):
        with self.get_connection() as conn:
            c = conn.cursor()
            c.execute('UPDATE users SET last_active = ? WHERE user_id = ?', 
                     (int(time.time()), user_id))
            self._clear_user_cache(user_id)
    
    def increment_stat(self, user_id, field):
        valid_fields = {'messages_received', 'messages_sent', 'link_clicks'}
        if field not in valid_fields:
            return
        
        with self.get_connection() as conn:
            c = conn.cursor()
            c.execute(f'UPDATE users SET {field} = {field} + 1 WHERE user_id = ?', 
                     (user_id,))
            self._clear_user_cache(user_id)
    
    def set_receive_messages(self, user_id, status):
        with self.get_connection() as conn:
            c = conn.cursor()
            c.execute('UPDATE users SET receive_messages = ? WHERE user_id = ?',
                     (1 if status else 0, user_id))
            self._clear_user_cache(user_id)
    
    def set_language(self, user_id, language):
        with self.get_connection() as conn:
            c = conn.cursor()
            c.execute('UPDATE users SET language = ? WHERE user_id = ?',
                     (language, user_id))
            self._clear_user_cache(user_id)
    
    def get_all_users_list(self):
        with self.get_connection() as conn:
            c = conn.cursor()
            c.execute('SELECT user_id FROM users WHERE is_blocked = 0')
            rows = c.fetchall()
            return [row[0] for row in rows]
    
    def get_all_users_count(self):
        with self.get_connection() as conn:
            c = conn.cursor()
            c.execute('SELECT COUNT(*) FROM users')
            return c.fetchone()[0]
    
    def save_message(self, sender_id, receiver_id, message_type, 
                    text="", file_id=None, file_unique_id=None, file_size=0,
                    replied_to=0, moderated=True):
        with self.get_connection() as conn:
            c = conn.cursor()
            c.execute('''
                INSERT INTO messages 
                (sender_id, receiver_id, message_type, text, file_id, file_unique_id, 
                 file_size, timestamp, replied_to, moderated) 
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
            ''', (sender_id, receiver_id, message_type, text, file_id, file_unique_id,
                  file_size, int(time.time()), replied_to, 1 if moderated else 0))
            message_id = c.lastrowid
            
            preview = text[:50] if text else f"[{message_type}]"
            
            c.execute('''
                INSERT OR REPLACE INTO user_history 
                (user_id, partner_id, message_id, direction, timestamp, preview) 
                VALUES (?, ?, ?, 'outgoing', ?, ?)
            ''', (sender_id, receiver_id, message_id, int(time.time()), preview))
            
            c.execute('''
                INSERT OR REPLACE INTO user_history 
                (user_id, partner_id, message_id, direction, timestamp, preview) 
                VALUES (?, ?, ?, 'incoming', ?, ?)
            ''', (receiver_id, sender_id, message_id, int(time.time()), preview))
            
            if admin_settings['notify_admin_new_message'] and message_type == 'text' and text:
                try:
                    sender = self.get_user(sender_id)
                    receiver = self.get_user(receiver_id)
                    
                    notification = f"""ğŸ“¨ ĞĞ¾Ğ²Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ

ğŸ‘¤ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒ: {sender_id}
â”œ Ğ˜Ğ¼Ñ: {sender['first_name'] if sender else '?'}
â”” Ğ®Ğ·ĞµÑ€Ğ½ĞµĞ¹Ğ¼: {f'@{sender['username']}' if sender and sender['username'] else 'Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚'}

ğŸ¯ ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ĞµĞ»ÑŒ: {receiver_id}
â”œ Ğ˜Ğ¼Ñ: {receiver['first_name'] if receiver else '?'}
â”” Ğ®Ğ·ĞµÑ€Ğ½ĞµĞ¹Ğ¼: {f'@{receiver['username']}' if receiver and receiver['username'] else 'Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚'}

ğŸ’¬ Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ: {text[:200]}{'...' if len(text) > 200 else ''}

â° Ğ’Ñ€ĞµĞ¼Ñ: {format_time(int(time.time()), 'ru')}"""
                    
                    bot.send_message(ADMIN_ID, notification)
                except:
                    pass
            
            return message_id
    
    def get_user_messages_stats(self, user_id):
        with self.get_connection() as conn:
            c = conn.cursor()
            c.execute('SELECT messages_received, messages_sent, link_clicks FROM users WHERE user_id = ?', (user_id,))
            row = c.fetchone()
            
            if row:
                return {
                    'messages_received': row['messages_received'],
                    'messages_sent': row['messages_sent'],
                    'link_clicks': row['link_clicks']
                }
            return {'messages_received': 0, 'messages_sent': 0, 'link_clicks': 0}
    
    def get_user_history(self, user_id, limit=20):
        with self.get_connection() as conn:
            c = conn.cursor()
            c.execute('''
                SELECT h.*, u.first_name as partner_name, u.username as partner_username
                FROM user_history h
                LEFT JOIN users u ON h.partner_id = u.user_id
                WHERE h.user_id = ?
                ORDER BY h.timestamp DESC
                LIMIT ?
            ''', (user_id, limit))
            
            rows = c.fetchall()
            history = []
            for row in rows:
                history.append({
                    'message_id': row['message_id'],
                    'partner_id': row['partner_id'],
                    'partner_name': row['partner_name'],
                    'partner_username': row['partner_username'],
                    'direction': row['direction'],
                    'timestamp': row['timestamp'],
                    'preview': row['preview']
                })
            return history
    
    def is_user_blocked(self, user_id):
        if user_id == ADMIN_ID:
            return False
        
        with self.get_connection() as conn:
            c = conn.cursor()
            c.execute('SELECT is_blocked FROM users WHERE user_id = ?', (user_id,))
            row = c.fetchone()
            return row['is_blocked'] == 1 if row else False
    
    def block_user(self, user_id, admin_id, reason=""):
        if user_id == ADMIN_ID:
            return False
        
        with self.get_connection() as conn:
            c = conn.cursor()
            c.execute('UPDATE users SET is_blocked = 1 WHERE user_id = ?', (user_id,))
            self._clear_user_cache(user_id)
            return True
    
    def unblock_user(self, user_id):
        with self.get_connection() as conn:
            c = conn.cursor()
            c.execute('UPDATE users SET is_blocked = 0 WHERE user_id = ?', (user_id,))
            success = c.rowcount > 0
            if success:
                self._clear_user_cache(user_id)
            return success
    
    def create_support_ticket(self, user_id, message, file_id=None,
                            file_unique_id=None, message_type="text"):
        with self.get_connection() as conn:
            c = conn.cursor()
            now = int(time.time())
            c.execute('''
                INSERT INTO support_tickets 
                (user_id, message, file_id, file_unique_id, message_type, created_at) 
                VALUES (?, ?, ?, ?, ?, ?)
            ''', (user_id, message, file_id, file_unique_id, message_type, now))
            return c.lastrowid
    
    def get_open_support_tickets(self):
        with self.get_connection() as conn:
            c = conn.cursor()
            c.execute('''
                SELECT s.*, u.first_name, u.username 
                FROM support_tickets s
                LEFT JOIN users u ON s.user_id = u.user_id
                WHERE s.status = 'open'
                ORDER BY s.created_at DESC
            ''')
            rows = c.fetchall()
            return [dict(row) for row in rows]
    
    def update_support_ticket(self, ticket_id, admin_id, 
                            reply_text, status='answered'):
        with self.get_connection() as conn:
            c = conn.cursor()
            now = int(time.time())
            c.execute('''
                UPDATE support_tickets 
                SET admin_id = ?, admin_reply = ?, replied_at = ?, status = ?
                WHERE id = ?
            ''', (admin_id, reply_text, now, status, ticket_id))
    
    def get_recent_messages(self, limit=10, include_text=True):
        with self.get_connection() as conn:
            c = conn.cursor()
            query = '''
                SELECT m.*, u1.first_name as sender_name, u1.username as sender_username,
                       u2.first_name as receiver_name, u2.username as receiver_username
                FROM messages m
                LEFT JOIN users u1 ON m.sender_id = u1.user_id
                LEFT JOIN users u2 ON m.receiver_id = u2.user_id
                ORDER BY m.timestamp DESC LIMIT ?
            '''
            c.execute(query, (limit,))
            rows = c.fetchall()
            messages = []
            for row in rows:
                msg = dict(row)
                if not include_text:
                    msg['text'] = '[HIDDEN]' if msg['text'] else ''
                messages.append(msg)
            return messages

    def export_users_data(self):
        with self.get_connection() as conn:
            c = conn.cursor()
            c.execute('''
                SELECT user_id, username, first_name, language, 
                       created_at, last_active, messages_received, 
                       messages_sent, link_clicks, receive_messages, is_blocked
                FROM users ORDER BY user_id
            ''')
            rows = c.fetchall()
            
            csv_content = "ID;Username;First Name;Language;Created At;Last Active;Messages Received;Messages Sent;Link Clicks;Receive Messages;Is Blocked\n"
            for row in rows:
                created = datetime.fromtimestamp(row['created_at']).strftime('%Y-%m-%d %H:%M')
                last_active = datetime.fromtimestamp(row['last_active']).strftime('%Y-%m-%d %H:%M') if row['last_active'] else "Never"
                csv_content += f"{row['user_id']};{row['username'] or ''};{row['first_name'] or ''};{row['language']};"
                csv_content += f"{created};{last_active};{row['messages_received']};{row['messages_sent']};"
                csv_content += f"{row['link_clicks']};{row['receive_messages']};{row['is_blocked']}\n"
            
            return csv_content

    def export_messages_data(self):
        with self.get_connection() as conn:
            c = conn.cursor()
            c.execute('''
                SELECT id, sender_id, receiver_id, message_type, text, timestamp
                FROM messages ORDER BY timestamp DESC LIMIT 1000
            ''')
            rows = c.fetchall()
            
            csv_content = "ID;Sender ID;Receiver ID;Type;Text;Timestamp\n"
            for row in rows:
                timestamp = datetime.fromtimestamp(row['timestamp']).strftime('%Y-%m-%d %H:%M')
                text = (row['text'] or '').replace(';', ',').replace('\n', ' ').replace('\r', '')
                csv_content += f"{row['id']};{row['sender_id']};{row['receiver_id']};{row['message_type']};{text};{timestamp}\n"
            
            return csv_content

db = Database()

@bot.message_handler(commands=['start'])
def start_command(message):
    user_id = message.from_user.id
    username = message.from_user.username or ""
    first_name = message.from_user.first_name or ""
    
    logger.info(f"Start from user_id={user_id}")
    
    if db.is_user_blocked(user_id):
        bot.send_message(user_id, get_text('ru', 'blocked'))
        return
    
    db.register_user(user_id, username, first_name)
    db.update_last_active(user_id)
    
    session_timestamps[user_id] = time.time()
    
    args = message.text.split()
    
    if len(args) > 1 and args[1].isdigit():
        target_id = int(args[1])
        handle_link_click(user_id, target_id)
        return
    
    user = db.get_user(user_id)
    lang = user['language'] if user else admin_settings['language']
    link = generate_link(user_id)
    
    bot.send_message(user_id, get_text(lang, 'start', link=link), 
                    reply_markup=main_keyboard(user_id == ADMIN_ID, lang))

def handle_link_click(clicker_id, target_id):
    target_user = db.get_user(target_id)
    if not target_user:
        bot.send_message(clicker_id, get_text('ru', 'user_not_found'))
        return
    
    if target_user['receive_messages'] == 0:
        bot.send_message(clicker_id, get_text('ru', 'messages_disabled'))
        return
    
    user_sessions[clicker_id] = {
        'target_id': target_id,
        'mode': 'anonymous'
    }
    db.increment_stat(target_id, 'link_clicks')
    
    user = db.get_user(clicker_id)
    lang = user['language'] if user else admin_settings['language']
    
    bot.send_message(
        clicker_id,
        get_text(lang, 'start_ref'),
        reply_markup=cancel_keyboard(lang)
    )

@bot.callback_query_handler(func=lambda call: True)
def handle_callback(call):
    user_id = call.from_user.id
    data = call.data
    
    try:
        user = db.get_user(user_id)
        lang = user['language'] if user else admin_settings['language']
        
        if data == "ignore":
            bot.answer_callback_query(call.id, "âœ… OK")
            return
        
        elif data == "refresh_logs":
            if user_id == ADMIN_ID:
                show_message_logs(admin_id=user_id)
                bot.answer_callback_query(call.id, get_text(lang, 'btn_refresh'))
            return
        
        elif data == "toggle_text":
            if user_id == ADMIN_ID:
                current = admin_modes.get(user_id, {}).get('show_text', True)
                admin_modes[user_id] = {'show_text': not current}
                show_message_logs(admin_id=user_id)
                bot.answer_callback_query(call.id, get_text(lang, 'settings'))
            return
        
        elif data.startswith("lang_"):
            language = data.split("_")[1]
            db.set_language(user_id, language)
            bot.answer_callback_query(call.id, get_text(language, 'language_changed'))
            
            link = generate_link(user_id)
            bot.send_message(user_id, get_text(language, 'start', link=link), 
                           reply_markup=main_keyboard(user_id == ADMIN_ID, language))
            return
        
        elif data.startswith("reply_"):
            message_id = int(data.split("_")[1])
            
            with db.get_connection() as conn:
                c = conn.cursor()
                c.execute('SELECT sender_id, receiver_id FROM messages WHERE id = ?', (message_id,))
                msg = c.fetchone()
                
                if msg and msg['receiver_id'] == user_id:
                    user_sessions[user_id] = {
                        'target_id': msg['sender_id'],
                        'mode': 'anonymous',
                        'reply_to': message_id
                    }
                    
                    bot.send_message(user_id, "ğŸ’Œ Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ²Ğ°Ñˆ Ğ¾Ñ‚Ğ²ĞµÑ‚:",
                                    reply_markup=cancel_keyboard(lang))
                    bot.answer_callback_query(call.id)
                else:
                    bot.answer_callback_query(call.id, "âŒ ĞÑˆĞ¸Ğ±ĞºĞ°")
        
        elif data.startswith("admin_block_"):
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            target_id = int(data.split("_")[2])
            if db.block_user(target_id, ADMIN_ID, "Admin panel"):
                bot.answer_callback_query(call.id, get_text(lang, 'block_user'))
                
                try:
                    bot.edit_message_text(
                        chat_id=call.message.chat.id,
                        message_id=call.message.message_id,
                        text=call.message.text + f"\n\n{get_text(lang, 'user_blocked')}",
                        reply_markup=get_admin_user_keyboard(target_id, True, lang)
                    )
                except:
                    pass
            else:
                bot.answer_callback_query(call.id, get_text(lang, 'user_already_blocked'))
        
        elif data.startswith("admin_unblock_"):
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            target_id = int(data.split("_")[2])
            if db.unblock_user(target_id):
                bot.answer_callback_query(call.id, get_text(lang, 'unblock_user'))
                
                try:
                    bot.edit_message_text(
                        chat_id=call.message.chat.id,
                        message_id=call.message.message_id,
                        text=call.message.text + "\n\nâœ… Unblocked",
                        reply_markup=get_admin_user_keyboard(target_id, False, lang)
                    )
                except:
                    pass
            else:
                bot.answer_callback_query(call.id, get_text(lang, 'user_not_blocked_msg'))
        
        elif data.startswith("admin_msg_"):
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            target_id = int(data.split("_")[2])
            admin_modes[user_id] = f'direct_msg_{target_id}'
            
            bot.send_message(user_id, get_text(lang, 'direct_message', user_id=target_id),
                           reply_markup=cancel_keyboard(lang))
            bot.answer_callback_query(call.id)
        
        elif data.startswith("support_reply_"):
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            ticket_id = int(data.split("_")[2])
            admin_modes[user_id] = f'support_reply_{ticket_id}'
            
            bot.send_message(user_id, f"ğŸ“ {get_text(lang, 'reply_to_ticket')} #{ticket_id}",
                           reply_markup=cancel_keyboard(lang))
            bot.answer_callback_query(call.id)
        
        elif data.startswith("support_close_"):
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            ticket_id = int(data.split("_")[2])
            db.update_support_ticket(ticket_id, user_id, "Closed", "closed")
            bot.answer_callback_query(call.id, "âœ… Closed")
            
            try:
                bot.edit_message_text(
                    chat_id=call.message.chat.id,
                    message_id=call.message.message_id,
                    text=call.message.text + "\n\nâœ… Ticket closed"
                )
            except:
                pass
        
        elif data.startswith("admin_user_"):
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            target_id = int(data.split("_")[2])
            find_user_info(admin_id=user_id, query=str(target_id), lang=lang)
            bot.answer_callback_query(call.id)
        
        elif data == "export_users":
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            export_users_data(admin_id=user_id, lang=lang)
            bot.answer_callback_query(call.id, get_text(lang, 'export_processing'))
        
        elif data == "export_messages":
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            export_messages_data(admin_id=user_id, lang=lang)
            bot.answer_callback_query(call.id, get_text(lang, 'export_processing'))
        
        elif data == "export_stats":
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            export_stats_data(admin_id=user_id, lang=lang)
            bot.answer_callback_query(call.id, get_text(lang, 'export_processing'))
        
        elif data == "export_cancel":
            bot.answer_callback_query(call.id, get_text(lang, 'canceled'))
            bot.send_message(user_id, get_text(lang, 'main_menu'), 
                           reply_markup=admin_keyboard(lang))
        
        elif data == "admin_settings_back":
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            show_admin_settings_menu(user_id, lang)
            bot.answer_callback_query(call.id)
        
        elif data == "admin_back":
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            bot.send_message(user_id, get_text(lang, 'admin_panel'), 
                           reply_markup=admin_keyboard(lang))
            bot.answer_callback_query(call.id)
        
        elif data == "toggle_auto_moderation":
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            admin_settings['auto_moderation'] = not admin_settings['auto_moderation']
            show_admin_settings_menu(user_id, lang)
            bot.answer_callback_query(call.id, 
                get_text(lang, 'auto_moderation_on' if admin_settings['auto_moderation'] else 'auto_moderation_off'))
        
        elif data == "toggle_notify_new_user":
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            admin_settings['notify_admin_new_user'] = not admin_settings['notify_admin_new_user']
            show_admin_settings_menu(user_id, lang)
            bot.answer_callback_query(call.id,
                get_text(lang, 'notify_new_user_on' if admin_settings['notify_admin_new_user'] else 'notify_new_user_off'))
        
        elif data == "toggle_notify_new_message":
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            admin_settings['notify_admin_new_message'] = not admin_settings['notify_admin_new_message']
            show_admin_settings_menu(user_id, lang)
            bot.answer_callback_query(call.id,
                get_text(lang, 'notify_new_message_on' if admin_settings['notify_admin_new_message'] else 'notify_new_message_off'))
        
        elif data == "change_backup_interval":
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            bot.send_message(user_id, "ğŸ• Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ» Ğ°Ğ²Ñ‚Ğ¾-Ğ±ÑĞºĞ°Ğ¿Ğ°:",
                           reply_markup=backup_interval_keyboard())
            bot.answer_callback_query(call.id)
        
        elif data.startswith("backup_"):
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            hours = int(data.split("_")[1])
            admin_settings['auto_backup_hours'] = hours
            show_admin_settings_menu(user_id, lang)
            bot.answer_callback_query(call.id, get_text(lang, 'backup_interval_changed'))
        
        elif data == "change_max_messages":
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            bot.send_message(user_id, "ğŸ“¨ Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ»Ğ¸Ğ¼Ğ¸Ñ‚ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹ Ğ² Ğ´ĞµĞ½ÑŒ:",
                           reply_markup=max_messages_keyboard())
            bot.answer_callback_query(call.id)
        
        elif data.startswith("max_"):
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            max_msgs = int(data.split("_")[1])
            admin_settings['max_messages_per_day'] = max_msgs
            show_admin_settings_menu(user_id, lang)
            bot.answer_callback_query(call.id, get_text(lang, 'max_messages_changed'))
        
        elif data == "change_bot_language":
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            bot.send_message(user_id, "ğŸŒ Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ ÑĞ·Ñ‹Ğº Ğ±Ğ¾Ñ‚Ğ°:",
                           reply_markup=bot_language_keyboard())
            bot.answer_callback_query(call.id)
        
        elif data.startswith("bot_lang_"):
            if user_id != ADMIN_ID:
                bot.answer_callback_query(call.id, "âŒ No access")
                return
            
            bot_lang = data.split("_")[2]
            admin_settings['language'] = bot_lang
            show_admin_settings_menu(user_id, lang)
            bot.answer_callback_query(call.id, get_text(lang, 'language_changed_admin'))
        
        else:
            bot.answer_callback_query(call.id, "âš ï¸ Unknown command")
        
    except Exception as e:
        logger.error(f"Callback error: {e}")
        bot.answer_callback_query(call.id, "âŒ Error")

@bot.message_handler(content_types=['text', 'photo', 'video', 'audio', 'voice', 'document', 'sticker'])
def handle_message(message):
    user_id = message.from_user.id
    message_type = message.content_type
    text = message.text or message.caption or ""
    
    if message.text and message.text.startswith('/'):
        return
    
    if db.is_user_blocked(user_id):
        bot.send_message(user_id, get_text('ru', 'blocked'))
        return
    
    allowed, wait_time = check_rate_limit(user_id)
    if not allowed:
        user = db.get_user(user_id)
        lang = user['language'] if user else admin_settings['language']
        bot.send_message(user_id, get_text(lang, 'rate_limit_exceeded', seconds=wait_time))
        return
    
    if not check_session_timeout(user_id):
        user = db.get_user(user_id)
        lang = user['language'] if user else admin_settings['language']
        bot.send_message(user_id, get_text(lang, 'session_expired'))
        bot.send_message(user_id, get_text(lang, 'main_menu'), 
                        reply_markup=main_keyboard(user_id == ADMIN_ID, lang))
        return
    
    db.update_last_active(user_id)
    user = db.get_user(user_id)
    lang = user['language'] if user else admin_settings['language']
    
    if text == get_text(lang, 'btn_cancel'):
        clear_user_state(user_id)
        bot.send_message(user_id, get_text(lang, 'canceled'), 
                        reply_markup=main_keyboard(user_id == ADMIN_ID, lang))
        return
    
    if text == get_text(lang, 'btn_admin') and user_id == ADMIN_ID:
        bot.send_message(user_id, get_text(lang, 'admin_panel'), 
                        reply_markup=admin_keyboard(lang))
        return
    
    if user_id == ADMIN_ID and user_id in admin_modes:
        mode = admin_modes[user_id]
        
        if isinstance(mode, str):
            if mode.startswith('direct_msg_'):
                target_id = int(mode.split('_')[2])
                send_direct_admin_message(message, target_id, lang)
                if user_id in admin_modes:
                    del admin_modes[user_id]
                return
            
            elif mode.startswith('support_reply_'):
                ticket_id = int(mode.split('_')[2])
                reply_to_support_ticket(message, ticket_id, lang)
                if user_id in admin_modes:
                    del admin_modes[user_id]
                return
    
    if text == get_text(lang, 'btn_support'):
        handle_support_request(message, lang)
        return
    
    if user_id in user_sessions and user_sessions[user_id]['mode'] == 'anonymous':
        target_id = user_sessions[user_id]['target_id']
        send_anonymous_message(user_id, target_id, message, lang)
        return
    
    if user_id in admin_modes and admin_modes[user_id] == 'support':
        create_support_ticket(message, lang)
        if user_id in admin_modes:
            del admin_modes[user_id]
        return
    
    if message_type == 'text':
        handle_text_button(user_id, text, lang)

def clear_user_state(user_id):
    if user_id in user_sessions:
        del user_sessions[user_id]
    if user_id in admin_modes:
        del admin_modes[user_id]

def handle_text_button(user_id, text, lang):
    is_admin = user_id == ADMIN_ID
    
    if text == get_text(lang, 'btn_my_link'):
        link = generate_link(user_id)
        stats = db.get_user_messages_stats(user_id)
        bot.send_message(user_id, get_text(lang, 'my_link', link=link, clicks=stats['link_clicks'], received=stats['messages_received']),
                        reply_markup=main_keyboard(is_admin, lang))
    
    elif text == get_text(lang, 'btn_profile'):
        show_profile(user_id, lang)
    
    elif text == get_text(lang, 'btn_stats'):
        show_user_stats(user_id, lang)
    
    elif text == get_text(lang, 'btn_settings'):
        bot.send_message(user_id, get_text(lang, 'settings'),
                        reply_markup=settings_keyboard(lang))
    
    elif text == get_text(lang, 'btn_qr'):
        generate_qr_code(user_id, lang)
    
    elif text == get_text(lang, 'btn_help'):
        show_help(user_id, lang)
    
    elif text == get_text(lang, 'btn_language'):
        bot.send_message(user_id, get_text(lang, 'language'),
                        reply_markup=language_keyboard())
    
    elif text == get_text(lang, 'btn_turn_on'):
        db.set_receive_messages(user_id, True)
        bot.send_message(user_id, get_text(lang, 'turn_on'),
                        reply_markup=settings_keyboard(lang))
    
    elif text == get_text(lang, 'btn_turn_off'):
        db.set_receive_messages(user_id, False)
        bot.send_message(user_id, get_text(lang, 'turn_off'),
                        reply_markup=settings_keyboard(lang))
    
    elif text == get_text(lang, 'btn_back'):
        bot.send_message(user_id, get_text(lang, 'main_menu'),
                        reply_markup=main_keyboard(is_admin, lang))
    
    elif is_admin:
        handle_admin_command(user_id, text, lang)

def show_profile(user_id, lang):
    user = db.get_user(user_id)
    
    if not user:
        bot.send_message(user_id, "âŒ ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½", 
                        reply_markup=main_keyboard(user_id == ADMIN_ID, lang))
        return
    
    stats = db.get_user_messages_stats(user_id)
    
    receive_status = "âœ… Ğ’ĞºĞ»ÑÑ‡ĞµĞ½" if user['receive_messages'] else "âŒ Ğ’Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½"
    username = f"@{user['username']}" if user['username'] else "âŒ Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚"
    language = "ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹" if user['language'] == 'ru' else "ğŸ‡ºğŸ‡¸ English"
    
    bot.send_message(user_id, get_text(lang, 'profile',
                                      user_id=user['user_id'],
                                      first_name=user['first_name'],
                                      username=username,
                                      language=language,
                                      registered=format_time(user['created_at'], lang),
                                      last_active=format_time(user['last_active'], lang),
                                      received=stats['messages_received'],
                                      sent=stats['messages_sent'],
                                      clicks=user['link_clicks'],
                                      receive_status=receive_status,
                                      link=generate_link(user_id)),
                    reply_markup=main_keyboard(user_id == ADMIN_ID, lang))

def show_user_stats(user_id, lang):
    user = db.get_user(user_id)
    
    if not user:
        bot.send_message(user_id, "âŒ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½", 
                        reply_markup=main_keyboard(user_id == ADMIN_ID, lang))
        return
    
    stats = db.get_user_messages_stats(user_id)
    
    stats_text = f"""ğŸ“Š <b>Ğ’Ğ°ÑˆĞ° ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°</b>

<b>ğŸ“ˆ ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸:</b>
â”œ ğŸ“¨ ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¾: <b>{stats['messages_received']}</b> ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
â”œ ğŸ“¤ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¾: <b>{stats['messages_sent']}</b> ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
â”” ğŸ”— ĞŸĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¾Ğ²: <b>{stats['link_clicks']}</b> Ñ€Ğ°Ğ·

<b>ğŸ“… ĞĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ:</b>
â”œ ğŸ“† Ğ—Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½: <b>{format_time(user['created_at'], lang)}</b>
â”” ğŸ“… ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½ÑÑ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ: <b>{format_time(user['last_active'], lang)}</b>

<b>âš™ï¸ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸:</b>
â”œ ĞŸÑ€Ğ¸Ñ‘Ğ¼ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹: {'âœ… Ğ’ĞºĞ»ÑÑ‡ĞµĞ½' if user['receive_messages'] else 'âŒ Ğ’Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½'}
â”” Ğ¯Ğ·Ñ‹Ğº: {'ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹' if user['language'] == 'ru' else 'ğŸ‡ºğŸ‡¸ English'}"""
    
    bot.send_message(user_id, stats_text, 
                    reply_markup=main_keyboard(user_id == ADMIN_ID, lang))

def send_anonymous_message(sender_id, receiver_id, message, lang):
    try:
        receiver = db.get_user(receiver_id)
        if not receiver or receiver['receive_messages'] == 0:
            bot.send_message(sender_id, get_text(lang, 'messages_disabled'))
            return
        
        message_type = message.content_type
        text = message.text or message.caption or ""
        
        if len(text) > MAX_MESSAGE_LENGTH:
            bot.send_message(sender_id, get_text(lang, 'message_too_long', max_length=MAX_MESSAGE_LENGTH))
            return
        
        if not check_content_moderation(text):
            bot.send_message(sender_id, get_text(lang, 'content_blocked'))
            return
        
        file_id = None
        file_unique_id = None
        file_size = 0
        
        if message_type == 'photo':
            file_id = message.photo[-1].file_id
            file_unique_id = message.photo[-1].file_unique_id
            file_size = message.photo[-1].file_size or 0
        elif message_type == 'video':
            file_id = message.video.file_id
            file_unique_id = message.video.file_unique_id
            file_size = message.video.file_size or 0
        elif message_type == 'audio':
            file_id = message.audio.file_id
            file_unique_id = message.audio.file_unique_id
            file_size = message.audio.file_size or 0
        elif message_type == 'voice':
            file_id = message.voice.file_id
            file_unique_id = message.voice.file_unique_id
            file_size = message.voice.file_size or 0
        elif message_type == 'document':
            file_id = message.document.file_id
            file_unique_id = message.document.file_unique_id
            file_size = message.document.file_size or 0
        elif message_type == 'sticker':
            file_id = message.sticker.file_id
            file_unique_id = message.sticker.file_unique_id
        
        if file_size > MAX_FILE_SIZE:
            max_size_mb = MAX_FILE_SIZE // (1024 * 1024)
            bot.send_message(sender_id, get_text(lang, 'file_too_large', max_size=max_size_mb))
            return
        
        replied_to = 0
        if sender_id in user_sessions and 'reply_to' in user_sessions[sender_id]:
            replied_to = user_sessions[sender_id]['reply_to']
        
        message_id = db.save_message(sender_id, receiver_id, message_type, 
                       text, file_id, file_unique_id, file_size, replied_to)
        
        db.increment_stat(sender_id, 'messages_sent')
        db.increment_stat(receiver_id, 'messages_received')
        
        receiver_lang = receiver['language'] if receiver else admin_settings['language']
        
        if text:
            message_content = f"ğŸ’¬ {text}"
        else:
            message_content = "ğŸ“ Ğ¤Ğ°Ğ¹Ğ»"
        
        try:
            if message_type == 'text':
                msg = bot.send_message(receiver_id, 
                    get_text(receiver_lang, 'anonymous_message', message_content=message_content),
                    reply_markup=get_message_reply_keyboard(message_id, receiver_lang))
            
            elif message_type == 'photo':
                msg = bot.send_photo(receiver_id, file_id,
                    caption=get_text(receiver_lang, 'anonymous_message', message_content=message_content),
                    reply_markup=get_message_reply_keyboard(message_id, receiver_lang))
            
            elif message_type == 'video':
                msg = bot.send_video(receiver_id, file_id,
                    caption=get_text(receiver_lang, 'anonymous_message', message_content=message_content),
                    reply_markup=get_message_reply_keyboard(message_id, receiver_lang))
            
            elif message_type == 'audio':
                msg = bot.send_audio(receiver_id, file_id,
                    caption=get_text(receiver_lang, 'anonymous_message', message_content=message_content),
                    reply_markup=get_message_reply_keyboard(message_id, receiver_lang))
            
            elif message_type == 'voice':
                msg = bot.send_voice(receiver_id, file_id,
                    caption=get_text(receiver_lang, 'anonymous_message', message_content=message_content),
                    reply_markup=get_message_reply_keyboard(message_id, receiver_lang))
            
            elif message_type == 'document':
                msg = bot.send_document(receiver_id, file_id,
                    caption=get_text(receiver_lang, 'anonymous_message', message_content=message_content),
                    reply_markup=get_message_reply_keyboard(message_id, receiver_lang))
            
            elif message_type == 'sticker':
                bot.send_message(receiver_id,
                    get_text(receiver_lang, 'anonymous_message', message_content="ğŸ˜œ Ğ¡Ñ‚Ğ¸ĞºĞµÑ€"),
                    reply_markup=get_message_reply_keyboard(message_id, receiver_lang))
                msg = bot.send_sticker(receiver_id, file_id)
        
        except ApiTelegramException as e:
            if e.error_code == 403:
                bot.send_message(sender_id, get_text(lang, 'user_blocked_bot'))
                return
            elif e.error_code == 400:
                bot.send_message(sender_id, "âŒ ĞÑˆĞ¸Ğ±ĞºĞ°: Ğ½ĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ")
            else:
                logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸: {e}")
                bot.send_message(sender_id, get_text(lang, 'system_error'))
            return
        
        bot.send_message(sender_id, get_text(lang, 'message_sent'),
                        reply_markup=cancel_keyboard(lang))
        
        if CHANNEL and CHANNEL != "":
            try:
                sender = db.get_user(sender_id)
                log_msg = f"""ğŸ“¨ ĞĞ¾Ğ²Ğ¾Ğµ Ğ°Ğ½Ğ¾Ğ½Ğ¸Ğ¼Ğ½Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ

ğŸ‘¤ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒ: {sender_id}
ğŸ¯ ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ĞµĞ»ÑŒ: {receiver_id}
ğŸ“ Ğ¢Ğ¸Ğ¿: {message_type}"""
                
                if text:
                    log_msg += f"\nğŸ’¬ Ğ¢ĞµĞºÑÑ‚: {text[:100]}"
                
                if file_id and message_type in ['photo', 'video']:
                    if message_type == 'photo':
                        bot.send_photo(CHANNEL, file_id, caption=log_msg)
                    elif message_type == 'video':
                        bot.send_video(CHANNEL, file_id, caption=log_msg)
                else:
                    bot.send_message(CHANNEL, log_msg)
            except Exception as e:
                logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° ĞºĞ°Ğ½Ğ°Ğ»Ğ°: {e}")
        
    except Exception as e:
        logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸: {e}")
        bot.send_message(sender_id, get_text(lang, 'system_error'))

def handle_support_request(message, lang):
    user_id = message.from_user.id
    bot.send_message(user_id, get_text(lang, 'support'), reply_markup=cancel_keyboard(lang))
    admin_modes[user_id] = 'support'

def create_support_ticket(message, lang):
    user_id = message.from_user.id
    message_type = message.content_type
    text = message.text or message.caption or ""
    
    if not text and message_type == 'text':
        bot.send_message(user_id, "âŒ Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ñ‚ĞµĞºÑÑ‚")
        return
    
    try:
        file_id = None
        file_unique_id = None
        
        if message_type == 'photo':
            file_id = message.photo[-1].file_id
            file_unique_id = message.photo[-1].file_unique_id
        elif message_type == 'video':
            file_id = message.video.file_id
            file_unique_id = message.video.file_unique_id
        elif message_type == 'document':
            file_id = message.document.file_id
            file_unique_id = message.document.file_unique_id
        elif message_type == 'sticker':
            file_id = message.sticker.file_id
            file_unique_id = message.sticker.file_unique_id
        
        ticket_id = db.create_support_ticket(user_id, text, file_id, file_unique_id, message_type)
        
        bot.send_message(user_id, get_text(lang, 'support_sent', ticket_id=ticket_id),
                        reply_markup=main_keyboard(user_id == ADMIN_ID, lang))
        
        notify_admin_about_ticket(ticket_id, user_id, message_type, text, file_id)
        
    except Exception as e:
        logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ñ‚Ğ¸ĞºĞµÑ‚Ğ°: {e}")
        bot.send_message(user_id, "âŒ ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ñ‚Ğ¸ĞºĞµÑ‚Ğ°")

def notify_admin_about_ticket(ticket_id, user_id, message_type, text, file_id):
    user = db.get_user(user_id)
    
    notification = f"""ğŸ†˜ ĞĞ¾Ğ²Ñ‹Ğ¹ Ñ‚Ğ¸ĞºĞµÑ‚ #{ticket_id}

ğŸ‘¤ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ: {user['first_name'] if user else '?'}
ğŸ“± Username: {f'@{user['username']}' if user and user['username'] else 'Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚'}
ğŸ“… Ğ’Ñ€ĞµĞ¼Ñ: {format_time(int(time.time()), 'ru')}
ğŸ“ Ğ¢Ğ¸Ğ¿: {message_type}"""
    
    if text:
        notification += f"\nğŸ’¬ Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ: {text[:200]}"
    
    try:
        if file_id:
            if message_type == 'photo':
                msg = bot.send_photo(ADMIN_ID, file_id, caption=notification, 
                                   reply_markup=get_admin_ticket_keyboard(ticket_id, user_id, 'ru'))
            elif message_type == 'video':
                msg = bot.send_video(ADMIN_ID, file_id, caption=notification,
                                   reply_markup=get_admin_ticket_keyboard(ticket_id, user_id, 'ru'))
            elif message_type == 'document':
                msg = bot.send_document(ADMIN_ID, file_id, caption=notification,
                                      reply_markup=get_admin_ticket_keyboard(ticket_id, user_id, 'ru'))
            elif message_type == 'sticker':
                bot.send_message(ADMIN_ID, notification,
                               reply_markup=get_admin_ticket_keyboard(ticket_id, user_id, 'ru'))
                bot.send_sticker(ADMIN_ID, file_id)
            else:
                msg = bot.send_message(ADMIN_ID, notification,
                                     reply_markup=get_admin_ticket_keyboard(ticket_id, user_id, 'ru'))
        else:
            msg = bot.send_message(ADMIN_ID, notification,
                                 reply_markup=get_admin_ticket_keyboard(ticket_id, user_id, 'ru'))
        
        if CHANNEL and CHANNEL != str(ADMIN_ID) and CHANNEL != "":
            try:
                if file_id:
                    if message_type == 'photo':
                        bot.send_photo(CHANNEL, file_id, caption=notification)
                    elif message_type == 'video':
                        bot.send_video(CHANNEL, file_id, caption=notification)
                    elif message_type == 'document':
                        bot.send_document(CHANNEL, file_id, caption=notification)
                    elif message_type == 'sticker':
                        bot.send_message(CHANNEL, notification)
                        bot.send_sticker(CHANNEL, file_id)
                else:
                    bot.send_message(CHANNEL, notification)
            except:
                pass
                
    except Exception as e:
        logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ: {e}")

def reply_to_support_ticket(message, ticket_id, lang):
    try:
        with db.get_connection() as conn:
            c = conn.cursor()
            c.execute('SELECT user_id, message FROM support_tickets WHERE id = ?', (ticket_id,))
            row = c.fetchone()
            
            if not row:
                bot.send_message(ADMIN_ID, "âŒ Ğ¢Ğ¸ĞºĞµÑ‚ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½.")
                return
            
            user_id, user_message = row
        
        message_type = message.content_type
        reply_text = message.text or message.caption or ""
        
        if not reply_text and message_type == 'text':
            bot.send_message(ADMIN_ID, "âŒ Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ñ‚ĞµĞºÑÑ‚")
            return
        
        file_id = None
        if message_type == 'photo':
            file_id = message.photo[-1].file_id
        elif message_type == 'video':
            file_id = message.video.file_id
        elif message_type == 'document':
            file_id = message.document.file_id
        elif message_type == 'sticker':
            file_id = message.sticker.file_id
        
        db.update_support_ticket(ticket_id, ADMIN_ID, reply_text, 'answered')
        
        user_reply = f"""ğŸ†˜ ĞÑ‚Ğ²ĞµÑ‚ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ¸

Ğ’Ğ°ÑˆĞµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ:
{user_message[:500]}

ĞĞ°Ñˆ Ğ¾Ñ‚Ğ²ĞµÑ‚:
{reply_text}

<i>Ğ¡ Ğ½Ğ°Ğ¸Ğ»ÑƒÑ‡ÑˆĞ¸Ğ¼Ğ¸ Ğ¿Ğ¾Ğ¶ĞµĞ»Ğ°Ğ½Ğ¸ÑĞ¼Ğ¸, ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° Ğ±Ğ¾Ñ‚Ğ° ğŸ¤–</i>"""
        
        try:
            if message_type == 'text':
                bot.send_message(user_id, user_reply)
            elif message_type == 'photo':
                bot.send_photo(user_id, file_id, caption=user_reply)
            elif message_type == 'video':
                bot.send_video(user_id, file_id, caption=user_reply)
            elif message_type == 'document':
                bot.send_document(user_id, file_id, caption=user_reply)
            elif message_type == 'sticker':
                bot.send_message(user_id, user_reply)
                bot.send_sticker(user_id, file_id)
        except ApiTelegramException as e:
            if e.error_code == 403:
                bot.send_message(ADMIN_ID, f"âŒ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ {user_id} Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ» Ğ±Ğ¾Ñ‚Ğ°.")
            else:
                raise
        
        bot.send_message(ADMIN_ID, f"âœ… ĞÑ‚Ğ²ĞµÑ‚ Ğ½Ğ° Ñ‚Ğ¸ĞºĞµÑ‚ #{ticket_id} Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½",
                        reply_markup=admin_keyboard(lang))
        
    except Exception as e:
        logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°: {e}")
        bot.send_message(ADMIN_ID, "âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°")

def send_direct_admin_message(message, target_user_id, lang):
    try:
        message_type = message.content_type
        text = message.text or message.caption or ""
        
        if not text and message_type == 'text':
            bot.send_message(ADMIN_ID, "âŒ Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ñ‚ĞµĞºÑÑ‚")
            return
        
        file_id = None
        if message_type == 'photo':
            file_id = message.photo[-1].file_id
        elif message_type == 'video':
            file_id = message.video.file_id
        elif message_type == 'document':
            file_id = message.document.file_id
        elif message_type == 'sticker':
            file_id = message.sticker.file_id
        
        user_message = f"""ğŸ“¢ Ğ’Ğ°Ğ¶Ğ½Ğ¾Ğµ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ

{text}

<i>Ğ¡ Ğ½Ğ°Ğ¸Ğ»ÑƒÑ‡ÑˆĞ¸Ğ¼Ğ¸ Ğ¿Ğ¾Ğ¶ĞµĞ»Ğ°Ğ½Ğ¸ÑĞ¼Ğ¸, ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° Ğ±Ğ¾Ñ‚Ğ° ğŸ¤–</i>"""
        
        try:
            if message_type == 'text':
                bot.send_message(target_user_id, user_message)
            elif message_type == 'photo':
                bot.send_photo(target_user_id, file_id, caption=user_message)
            elif message_type == 'video':
                bot.send_video(target_user_id, file_id, caption=user_message)
            elif message_type == 'document':
                bot.send_document(target_user_id, file_id, caption=user_message)
            elif message_type == 'sticker':
                bot.send_message(target_user_id, user_message)
                bot.send_sticker(target_user_id, file_id)
        except ApiTelegramException as e:
            if e.error_code == 403:
                bot.send_message(ADMIN_ID, f"âŒ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ {target_user_id} Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ» Ğ±Ğ¾Ñ‚Ğ°.")
                return
            else:
                raise
        
        bot.send_message(ADMIN_ID, get_text(lang, 'message_sent_admin', user_id=target_user_id, message_type=message_type),
                        reply_markup=admin_keyboard(lang))
        
    except Exception as e:
        logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€ÑĞ¼Ğ¾Ğ³Ğ¾ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ: {e}")
        bot.send_message(ADMIN_ID, "âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸")

def generate_qr_code(user_id, lang):
    link = generate_link(user_id)
    
    try:
        qr = qrcode.QRCode(
            version=1,
            box_size=6,
            border=2,
            error_correction=qrcode.constants.ERROR_CORRECT_L
        )
        qr.add_data(link)
        qr.make(fit=True)
        
        img = qr.make_image(fill_color="black", back_color="white")
        bio = BytesIO()
        img.save(bio, 'PNG', optimize=True, quality=85)
        bio.seek(0)
        
        bot.send_photo(user_id, photo=bio, caption=get_text(lang, 'qr_code', link=link),
                      reply_markup=main_keyboard(user_id == ADMIN_ID, lang))
    except Exception as e:
        logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° QR: {e}")
        bot.send_message(user_id, "âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ QR-ĞºĞ¾Ğ´Ğ°")

def show_help(user_id, lang):
    bot.send_message(user_id, get_text(lang, 'help'), 
                    reply_markup=main_keyboard(user_id == ADMIN_ID, lang))

def handle_admin_command(admin_id, text, lang):
    
    if text == get_text(lang, 'btn_admin_stats'):
        show_admin_stats(admin_id, lang)
    
    elif text == get_text(lang, 'btn_admin_broadcast'):
        admin_modes[admin_id] = 'broadcast'
        bot.send_message(admin_id, get_text(lang, 'broadcast_start'), reply_markup=cancel_keyboard(lang))
    
    elif text == get_text(lang, 'btn_admin_find'):
        admin_modes[admin_id] = 'find_user'
        bot.send_message(admin_id, get_text(lang, 'find_user'), reply_markup=cancel_keyboard(lang))
    
    elif text == get_text(lang, 'btn_admin_logs'):
        show_message_logs(admin_id, lang)
    
    elif text == get_text(lang, 'btn_admin_tickets'):
        show_support_tickets(admin_id, lang)
    
    elif text == get_text(lang, 'btn_admin_settings'):
        show_admin_settings_menu(admin_id, lang)
    
    elif text == get_text(lang, 'btn_admin_block'):
        admin_modes[admin_id] = 'block_user'
        bot.send_message(admin_id, get_text(lang, 'block_instruction'), reply_markup=cancel_keyboard(lang))
    
    elif text == get_text(lang, 'btn_admin_backup'):
        create_backup(admin_id, lang)
    
    elif text == get_text(lang, 'btn_admin_export'):
        bot.send_message(admin_id, get_text(lang, 'export_instruction'), reply_markup=export_keyboard(lang))
    
    elif text == get_text(lang, 'btn_back'):
        bot.send_message(admin_id, get_text(lang, 'main_menu'), reply_markup=main_keyboard(True, lang))
    
    elif admin_id in admin_modes:
        mode = admin_modes[admin_id]
        
        if mode == 'broadcast':
            start_broadcast(admin_id, text, lang)
            if admin_id in admin_modes:
                del admin_modes[admin_id]
        
        elif mode == 'find_user':
            find_user_info(admin_id, text, lang)
            if admin_id in admin_modes:
                del admin_modes[admin_id]
        
        elif mode == 'block_user':
            handle_block_user(admin_id, text, lang)
            if admin_id in admin_modes:
                del admin_modes[admin_id]

def show_admin_stats(admin_id, lang):
    stats = db.get_admin_stats()
    
    stats_text = get_text(lang, 'admin_stats',
                   total_users=stats['total_users'],
                   today_active=stats['today_active'],
                   total_messages=stats['total_messages'],
                   messages_24h=stats['messages_24h'],
                   new_users_24h=stats['new_users_24h'],
                   blocked_users=stats['blocked_users'],
                   open_tickets=stats['open_tickets'],
                   avg_hourly=stats['avg_hourly'],
                   users_week=stats['users_week'],
                   messages_week=stats['messages_week'],
                   active_week=stats['active_week'],
                   retention_30d=stats['retention_30d'],
                   conversion_rate=stats['conversion_rate'])
    
    bot.send_message(admin_id, stats_text, reply_markup=admin_keyboard(lang))

def start_broadcast(admin_id, message, lang):
    try:
        if isinstance(message, str):
            text = message
        else:
            text = message.text or message.caption or ""
            
        if not text:
            bot.send_message(admin_id, "âŒ Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ñ‚ĞµĞºÑÑ‚ Ñ€Ğ°ÑÑÑ‹Ğ»ĞºĞ¸")
            return
        
        users = db.get_all_users_list()
        total = len(users)
        
        if total == 0:
            bot.send_message(admin_id, "âŒ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹")
            return
        
        sent = 0
        failed = 0
        blocked = 0
        
        progress_msg = bot.send_message(admin_id, get_text(lang, 'broadcast_progress', total=total))
        
        for user_id in users:
            try:
                if db.is_user_blocked(user_id):
                    blocked += 1
                    continue
                
                bot.send_message(user_id, text, parse_mode="HTML")
                sent += 1
                time.sleep(0.05)
            except:
                failed += 1
        
        bot.edit_message_text(
            chat_id=admin_id,
            message_id=progress_msg.message_id,
            text=get_text(lang, 'broadcast_result', total=total, sent=sent, failed=failed, blocked=blocked)
        )
        
    except Exception as e:
        logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ñ€Ğ°ÑÑÑ‹Ğ»ĞºĞ¸: {e}")
        bot.send_message(admin_id, f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ°: {e}")

def find_user_info(admin_id, query, lang=None):
    if lang is None:
        user = db.get_user(admin_id)
        lang = user['language'] if user else admin_settings['language']
    
    try:
        user = None
        
        if query.isdigit():
            user_id = int(query)
            user = db.get_user(user_id)
        else:
            username = query.lstrip('@')
            user = db.get_user_by_username(username)
        
        if not user:
            bot.send_message(admin_id, get_text(lang, 'user_not_found'), reply_markup=admin_keyboard(lang))
            return
        
        stats = db.get_user_messages_stats(user['user_id'])
        is_blocked = db.is_user_blocked(user['user_id'])
        activity_stats = get_user_activity_stats(user['user_id'])
        top_words = get_top_words(user['user_id'], 5)
        
        username = f"@{user['username']}" if user['username'] else "âŒ Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚"
        receive_status = "âœ… Ğ’ĞºĞ»ÑÑ‡ĞµĞ½" if user['receive_messages'] else "âŒ Ğ’Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½"
        block_status = "ğŸ”´ Ğ—ĞĞ‘Ğ›ĞĞšĞ˜Ğ ĞĞ’ĞĞ" if is_blocked else "ğŸŸ¢ ĞĞšĞ¢Ğ˜Ğ’Ğ•Ğ"
        language = "ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹" if user['language'] == 'ru' else "ğŸ‡ºğŸ‡¸ English"
        
        if top_words:
            top_words_str = ", ".join([f"{word} ({count})" for word, count in top_words])
        else:
            top_words_str = "ĞĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…"
        
        user_info = get_text(lang, 'user_info',
                     user_id=user['user_id'],
                     first_name=user['first_name'],
                     username=username,
                     language=language,
                     registered=format_time(user['created_at'], lang),
                     last_active=format_time(user['last_active'], lang),
                     received=stats['messages_received'],
                     sent=stats['messages_sent'],
                     clicks=user['link_clicks'],
                     activity_week=f"{activity_stats['messages_week']} ÑĞ¾Ğ¾Ğ±Ñ‰. / {activity_stats['active_days']} Ğ´Ğ½ĞµĞ¹",
                     top_words=top_words_str,
                     unique_words=activity_stats['unique_words'],
                     receive_status=receive_status,
                     block_status=block_status)
        
        bot.send_message(admin_id, user_info, 
                        reply_markup=get_admin_user_keyboard(user['user_id'], is_blocked, lang))
        
    except Exception as e:
        logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ: {e}")
        bot.send_message(admin_id, f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ°: {e}", reply_markup=admin_keyboard(lang))

def handle_block_user(admin_id, query, lang):
    try:
        user = None
        
        if query.isdigit():
            user_id = int(query)
            user = db.get_user(user_id)
        else:
            username = query.lstrip('@')
            user = db.get_user_by_username(username)
        
        if not user:
            bot.send_message(admin_id, get_text(lang, 'user_not_found'), reply_markup=admin_keyboard(lang))
            return
        
        is_blocked = db.is_user_blocked(user['user_id'])
        
        if is_blocked:
            if db.unblock_user(user['user_id']):
                bot.send_message(admin_id, get_text(lang, 'unblock_success', user_id=user['user_id']),
                               reply_markup=admin_keyboard(lang))
            else:
                bot.send_message(admin_id, get_text(lang, 'user_not_blocked_msg'),
                               reply_markup=admin_keyboard(lang))
        else:
            if db.block_user(user['user_id'], admin_id, "Block panel"):
                bot.send_message(admin_id, get_text(lang, 'block_success', user_id=user['user_id']),
                               reply_markup=admin_keyboard(lang))
            else:
                bot.send_message(admin_id, get_text(lang, 'user_already_blocked'),
                               reply_markup=admin_keyboard(lang))
        
    except Exception as e:
        logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ: {e}")
        bot.send_message(admin_id, f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ°: {e}", reply_markup=admin_keyboard(lang))

def show_message_logs(admin_id, lang):
    show_text = admin_modes.get(admin_id, {}).get('show_text', True) if isinstance(admin_modes.get(admin_id), dict) else True
    messages = db.get_recent_messages(limit=10, include_text=show_text)
    
    if not messages:
        bot.send_message(admin_id, get_text(lang, 'no_logs'), reply_markup=get_admin_log_keyboard(show_text, lang))
        return
    
    logs_text = f"{get_text(lang, 'logs')}:\n\n"
    
    for i, msg in enumerate(messages, 1):
        sender_name = msg.get('sender_name', '?')
        receiver_name = msg.get('receiver_name', '?')
        
        logs_text += f"{i}. {format_time(msg['timestamp'], lang)}\n"
        logs_text += f"   ğŸ‘¤ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒ: {msg['sender_id']} - {sender_name}\n"
        logs_text += f"   ğŸ¯ ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ĞµĞ»ÑŒ: {msg['receiver_id']} - {receiver_name}\n"
        logs_text += f"   ğŸ“ Ğ¢Ğ¸Ğ¿: {msg['message_type']}\n"
        
        if msg['text']:
            logs_text += f"   ğŸ’¬ Ğ¢ĞµĞºÑÑ‚: {msg['text']}\n"
        
        logs_text += "\n"
    
    bot.send_message(admin_id, logs_text, reply_markup=get_admin_log_keyboard(show_text, lang))

def show_support_tickets(admin_id, lang):
    tickets = db.get_open_support_tickets()
    
    if not tickets:
        bot.send_message(admin_id, get_text(lang, 'no_tickets'), reply_markup=admin_keyboard(lang))
        return
    
    tickets_text = f"{get_text(lang, 'tickets')} ({len(tickets)}):\n\n"
    
    for i, ticket in enumerate(tickets, 1):
        tickets_text += f"{i}. Ğ¢Ğ¸ĞºĞµÑ‚ #{ticket['id']}\n"
        tickets_text += f"   ğŸ‘¤ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ: {ticket['user_id']} - {ticket['first_name']}\n"
        tickets_text += f"   ğŸ“± Username: {f'@{ticket['username']}' if ticket['username'] else 'Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚'}\n"
        tickets_text += f"   ğŸ“… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½: {format_time(ticket['created_at'], lang)}\n"
        
        if ticket['message']:
            preview = ticket['message'][:100] + "..." if len(ticket['message']) > 100 else ticket['message']
            tickets_text += f"   ğŸ’¬ Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ: {preview}\n"
        
        tickets_text += f"   ğŸ“ Ğ¢Ğ¸Ğ¿: {ticket['message_type']}\n\n"
    
    bot.send_message(admin_id, tickets_text, reply_markup=admin_keyboard(lang))

def show_admin_settings_menu(admin_id, lang):
    bot.send_message(admin_id, get_text(lang, 'admin_settings_menu'),
                    reply_markup=admin_settings_keyboard(lang))

def create_backup(admin_id, lang):
    try:
        backup_filename = f"backup_{datetime.now().strftime('%Y%m%d_%H%M%S')}.db"
        
        with open(DB_PATH, 'rb') as f:
            db_content = f.read()
        
        bio = BytesIO(db_content)
        bio.name = backup_filename
        
        bot.send_document(admin_id, bio, 
                         caption=f"ğŸ’¾ Ğ‘ÑĞºĞ°Ğ¿ Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…\nğŸ“… {datetime.now().strftime('%d.%m.%Y %H:%M')}")
        
    except Exception as e:
        logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ±ÑĞºĞ°Ğ¿Ğ°: {e}")
        bot.send_message(admin_id, f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ±ÑĞºĞ°Ğ¿Ğ°: {e}")

def export_users_data(admin_id, lang):
    try:
        csv_content = db.export_users_data()
        bio = BytesIO(csv_content.encode('utf-8'))
        bio.name = f"users_export_{datetime.now().strftime('%Y%m%d')}.csv"
        
        bot.send_document(admin_id, bio, caption=get_text(lang, 'export_complete'))
        
    except Exception as e:
        logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ° Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹: {e}")
        bot.send_message(admin_id, f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ°: {e}")

def export_messages_data(admin_id, lang):
    try:
        csv_content = db.export_messages_data()
        bio = BytesIO(csv_content.encode('utf-8'))
        bio.name = f"messages_export_{datetime.now().strftime('%Y%m%d')}.csv"
        
        bot.send_document(admin_id, bio, caption=get_text(lang, 'export_complete'))
        
    except Exception as e:
        logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ° ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹: {e}")
        bot.send_message(admin_id, f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ°: {e}")

def export_stats_data(admin_id, lang):
    try:
        stats = db.get_admin_stats()
        
        stats_text = f"""ğŸ“Š Anony SMS Bot Statistics
ğŸ“… {datetime.now().strftime('%d.%m.%Y %H:%M:%S')}

ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸:
â”œ Ğ’ÑĞµĞ³Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹: {stats['total_users']}
â”œ ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ: {stats['today_active']}
â”œ Ğ’ÑĞµĞ³Ğ¾ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹: {stats['total_messages']}
â”œ Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹ Ğ·Ğ° 24Ñ‡: {stats['messages_24h']}
â”œ ĞĞ¾Ğ²Ñ‹Ñ… Ğ·Ğ° 24Ñ‡: {stats['new_users_24h']}
â”œ Ğ—Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ…: {stats['blocked_users']}
â”œ ĞÑ‚ĞºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ñ‚Ğ¸ĞºĞµÑ‚Ğ¾Ğ²: {stats['open_tickets']}
â”” Ğ¡Ñ€ĞµĞ´. Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ² Ñ‡Ğ°Ñ: {stats['avg_hourly']}

Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°:
â”œ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ Ğ·Ğ° Ğ½ĞµĞ´ĞµĞ»Ñ: {stats['users_week']}
â”œ Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹ Ğ·Ğ° Ğ½ĞµĞ´ĞµĞ»Ñ: {stats['messages_week']}
â”œ ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… Ğ·Ğ° Ğ½ĞµĞ´ĞµĞ»Ñ: {stats['active_week']}
â”œ Ğ£Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ (30 Ğ´Ğ½ĞµĞ¹): {stats['retention_30d']}%
â”” ĞšĞ¾Ğ½Ğ²ĞµÑ€ÑĞ¸Ñ Ğ² ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ: {stats['conversion_rate']}%
"""
        
        bio = BytesIO(stats_text.encode('utf-8'))
        bio.name = f"stats_export_{datetime.now().strftime('%Y%m%d')}.txt"
        
        bot.send_document(admin_id, bio, caption=get_text(lang, 'export_complete'))
        
    except Exception as e:
        logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ° ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸: {e}")
        bot.send_message(admin_id, f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ°: {e}")

def monitor_bot():
    while True:
        try:
            with db.get_connection() as conn:
                c = conn.cursor()
                c.execute('PRAGMA integrity_check')
                result = c.fetchone()
                if result[0] != 'ok':
                    logger.warning(f"ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° Ñ†ĞµĞ»Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ‘Ğ”: {result[0]}")
            except Exception as e:
                logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ‘Ğ”: {e}")
            
            current_time = time.time()
            keys_to_delete = []
            for key, timestamp in session_timestamps.items():
                if current_time - timestamp > SESSION_TIMEOUT * 2:
                    keys_to_delete.append(key)
            
            for key in keys_to_delete:
                del session_timestamps[key]
                if key in user_sessions:
                    del user_sessions[key]
                if key in admin_modes:
                    del admin_modes[key]
            
            time.sleep(3600)
            
        except Exception as e:
            logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°: {e}")
            time.sleep(300)

@app.route('/webhook', methods=['POST'])
def webhook():
    try:
        if request.headers.get('content-type') == 'application/json':
            json_string = request.get_data(as_text=True)
            update = types.Update.de_json(json_string)
            bot.process_new_updates([update])
            return 'OK', 200
        return 'Invalid content type', 400
    except Exception as e:
        logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ²ĞµĞ±Ñ…ÑƒĞºĞ°: {e}")
        return 'ERROR', 500

@app.route('/health', methods=['GET'])
def health_check():
    try:
        stats = db.get_admin_stats()
        return jsonify({
            'status': 'ok', 
            'time': datetime.now().isoformat(),
            'bot': 'Anony SMS',
            'version': '12.0',
            'users': stats['total_users'],
            'messages': stats['total_messages'],
        })
    except Exception as e:
        logger.error(f"ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒÑ: {e}")
        return jsonify({'status': 'error', 'error': str(e)}), 500

@app.route('/ping', methods=['GET'])
def ping():
    return jsonify({'status': 'active', 'timestamp': time.time()})

if __name__ == '__main__':
    logger.info("=" * 60)
    logger.info("ğŸš€ Anony SMS Bot v12.0 - Ultimate Professional Edition")
    logger.info("=" * 60)
    
    if not TOKEN:
        logger.error("âŒ Ğ¢Ğ¾ĞºĞµĞ½ Ğ±Ğ¾Ñ‚Ğ° Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½! Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½ÑƒÑ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ PLAY.")
        sys.exit(1)
    
    try:
        bot_info = bot.get_me()
        logger.info(f"ğŸ¤– Ğ‘Ğ¾Ñ‚: @{bot_info.username} ({bot_info.first_name})")
        logger.info(f"ğŸ‘‘ Admin ID: {ADMIN_ID}")
        logger.info(f"ğŸ“¢ ĞšĞ°Ğ½Ğ°Ğ»: {CHANNEL if CHANNEL else 'ĞĞµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½'}")
        logger.info(f"ğŸŒ Webhook: {WEBHOOK_HOST if WEBHOOK_HOST else 'Polling mode'}")
        logger.info(f"ğŸ’¾ Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…: {DB_PATH}")
    except Exception as e:
        logger.error(f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ğ±Ğ¾Ñ‚Ğ°: {e}")
        sys.exit(1)
    
    try:
        monitor_thread = threading.Thread(target=monitor_bot, daemon=True)
        monitor_thread.start()
        logger.info("âœ… ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½")
    except Exception as e:
        logger.error(f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ñ„Ğ¾Ğ½Ğ¾Ğ²Ñ‹Ñ… ÑĞ»ÑƒĞ¶Ğ±: {e}")
    
    try:
        if WEBHOOK_HOST:
            logger.info(f"ğŸŒ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° webhook Ğ´Ğ»Ñ {WEBHOOK_HOST}")
            
            try:
                bot.remove_webhook()
                time.sleep(1)
            except:
                pass
            
            bot.set_webhook(
                url=f"{WEBHOOK_HOST}/webhook",
                max_connections=100,
                timeout=60,
                drop_pending_updates=True,
                allowed_updates=None
            )
            logger.info("âœ… Webhook Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾")
            
            app.run(
                host='0.0.0.0',
                port=PORT,
                debug=False,
                threaded=True,
                use_reloader=False
            )
            
        else:
            logger.info("ğŸ”„ Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ² Ñ€ĞµĞ¶Ğ¸Ğ¼Ğµ polling")
            bot.remove_webhook()
            bot.polling(
                none_stop=True,
                interval=0,
                timeout=20,
                long_polling_timeout=20,
                logger_level=logging.INFO
            )
            
    except KeyboardInterrupt:
        logger.info("ğŸ‘‹ Ğ‘Ğ¾Ñ‚ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¼")
        sys.exit(0)
    except Exception as e:
        logger.error(f"âŒ ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°: {e}")
        import traceback
        logger.error(traceback.format_exc())
        sys.exit(1)
